
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ibm.github.io/ICX360/reference/library_reference/">
      
      
        <link rel="prev" href="../../examples/th/LLM_jailbreak/">
      
      
      
      <link rel="icon" href="../../assets/icx360_logos/png/lightmode_icx_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Library commands - ICX360</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ICX360" class="md-header__button md-logo" aria-label="ICX360" data-md-component="logo">
      
  <img src="../../assets/icx360_logos/png/lightmode_icx_favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ICX360
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Library commands
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/IBM/ICX360" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    IBM/ICX360
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  Python Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ICX360" class="md-nav__button md-logo" aria-label="ICX360" data-md-component="logo">
      
  <img src="../../assets/icx360_logos/png/lightmode_icx_favicon.png" alt="logo">

    </a>
    ICX360
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/IBM/ICX360" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    IBM/ICX360
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🚀 Quickstart
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            🚀 Quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mexgen/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MExGen Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/cell/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CELL Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/th/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Token Highlighter Jailbreak Inspector Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🔍 MExGen
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            🔍 MExGen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mexgen/question_answering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MExGen for Question Answering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mexgen/RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MExGen for Retrieval Augmented Generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mexgen/summarization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MExGen for Summarization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🔍 CELL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            🔍 CELL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/cell/natural_language_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CELL for Natural Language Generation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🔍 Token Highlighter
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            🔍 Token Highlighter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/th/LLM_jailbreak/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Token Highlighter Jailbreak Inspector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Python Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Python Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Library commands
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Library commands
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#icx360" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;icx360
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" icx360">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cell
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.CELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;CELL
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CELL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.CELL.CELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CELL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.mCELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;mCELL
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" mCELL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.mCELL.mCELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;mCELL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lbbe
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lbbe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.ABC" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LocalBBExplainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LocalBBExplainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer.explain_instance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;explain_instance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lwbe
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lwbe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.ABC" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LocalWBExplainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LocalWBExplainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer.explain_instance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;explain_instance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;mexgen
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" mexgen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;clime
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" clime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.CLIME" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CLIME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.compute_linear_model_features" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_linear_model_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.fit_linear_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fit_linear_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lshap
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lshap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.LSHAP" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LSHAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.adapt_replacement_set" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;adapt_replacement_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.get_normalization_constants" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_normalization_constants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;token_highlighter
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" token_highlighter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter.th_llm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;th_llm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" th_llm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenHighlighter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;perturb_curve
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" perturb_curve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PerturbCurveEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PerturbCurveEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.scalarized_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scalarized_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.eval_perturb_curve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;eval_perturb_curve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;coloring_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" coloring_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_30" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;COLOR_LIST_IBM_30
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_40" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;COLOR_LIST_IBM_40
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.color_units" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;color_units
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.highlight_text" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;highlight_text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;general_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" general_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils.fix_seed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fix_seed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils.select_device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;select_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;infillers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" infillers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.BART_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;BART_infiller
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BART_infiller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.BART_infiller.BART_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BART_infiller
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.T5_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;T5_infiller
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" T5_infiller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.T5_infiller.T5_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;T5_infiller
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;model_wrappers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" model_wrappers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base_model_wrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base_model_wrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GeneratedOutput
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper.Model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.huggingface" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;huggingface
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" huggingface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.huggingface.HFModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HFModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.vllm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;vllm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" vllm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.vllm.VLLMModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VLLMModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;scalarizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" scalarizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bart_score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;bart_score
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" bart_score">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bart_score.BARTScorer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BARTScorer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.base_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Scalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bleu_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;bleu_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" bleu_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BleuScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.contradiction_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contradiction_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contradiction_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ContradictionScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.nli_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nli_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nli_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NLIScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.preference_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;preference_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" preference_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PreferenceScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.prob" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.prob.ProbScalarizedModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ProbScalarizedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.text_only" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;text_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" text_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.text_only.TextScalarizedModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TextScalarizedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segmenters
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" segmenters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;spacy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" spacy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.SpaCySegmenter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SpaCySegmenter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.append_or_segment_children" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;append_or_segment_children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.append_or_segment_span" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;append_or_segment_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.is_not_punct_space" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_not_punct_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_nbor_of_singleton_phrase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_nbor_of_singleton_phrase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_noun_chunk_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_noun_chunk_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_phrase_spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_phrase_spans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_singleton_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_singleton_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.segment_into_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;segment_into_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.sort_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sort_phrases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.utils.exclude_non_alphanumeric" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;exclude_non_alphanumeric
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;subset_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" subset_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils.mask_subsets" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mask_subsets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils.sample_subsets" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sample_subsets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;toma
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" toma">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_call" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_generate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_generate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_get_probs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_get_probs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#icx360" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;icx360
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" icx360">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cell
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.CELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;CELL
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CELL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.CELL.CELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CELL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.mCELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;mCELL
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" mCELL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.cell.mCELL.mCELL" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;mCELL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lbbe
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lbbe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.ABC" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LocalBBExplainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LocalBBExplainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer.explain_instance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;explain_instance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lbbe.LocalBBExplainer.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lwbe
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lwbe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.ABC" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LocalWBExplainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LocalWBExplainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer.explain_instance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;explain_instance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.lwbe.LocalWBExplainer.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;mexgen
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" mexgen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;clime
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" clime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.CLIME" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CLIME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.compute_linear_model_features" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_linear_model_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.clime.fit_linear_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fit_linear_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lshap
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lshap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.LSHAP" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LSHAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.adapt_replacement_set" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;adapt_replacement_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.mexgen.lshap.get_normalization_constants" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_normalization_constants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;token_highlighter
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" token_highlighter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter.th_llm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;th_llm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" th_llm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenHighlighter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;perturb_curve
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" perturb_curve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PerturbCurveEvaluator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PerturbCurveEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.scalarized_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scalarized_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.eval_perturb_curve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;eval_perturb_curve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;coloring_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" coloring_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_30" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;COLOR_LIST_IBM_30
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_40" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;COLOR_LIST_IBM_40
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.color_units" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;color_units
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.coloring_utils.highlight_text" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;highlight_text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;general_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" general_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils.fix_seed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;fix_seed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.general_utils.select_device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;select_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;infillers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" infillers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.BART_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;BART_infiller
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BART_infiller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.BART_infiller.BART_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BART_infiller
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.T5_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;T5_infiller
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" T5_infiller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.infillers.T5_infiller.T5_infiller" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;T5_infiller
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;model_wrappers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" model_wrappers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base_model_wrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base_model_wrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GeneratedOutput
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.base_model_wrapper.Model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.huggingface" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;huggingface
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" huggingface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.huggingface.HFModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HFModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.vllm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;vllm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" vllm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.model_wrappers.vllm.VLLMModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VLLMModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;scalarizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" scalarizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bart_score" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;bart_score
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" bart_score">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bart_score.BARTScorer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BARTScorer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.base_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Scalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bleu_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;bleu_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" bleu_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BleuScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.contradiction_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contradiction_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contradiction_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ContradictionScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.nli_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nli_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nli_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NLIScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.preference_scalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;preference_scalarizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" preference_scalarizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PreferenceScalarizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.prob" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.prob.ProbScalarizedModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ProbScalarizedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.text_only" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;text_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" text_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.scalarizers.text_only.TextScalarizedModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TextScalarizedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segmenters
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" segmenters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;spacy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" spacy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.SpaCySegmenter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SpaCySegmenter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.append_or_segment_children" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;append_or_segment_children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.append_or_segment_span" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;append_or_segment_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.is_not_punct_space" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_not_punct_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_nbor_of_singleton_phrase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_nbor_of_singleton_phrase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_noun_chunk_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_noun_chunk_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_phrase_spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_phrase_spans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.merge_singleton_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;merge_singleton_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.segment_into_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;segment_into_phrases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.spacy.sort_phrases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sort_phrases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.segmenters.utils.exclude_non_alphanumeric" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;exclude_non_alphanumeric
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;subset_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" subset_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils.mask_subsets" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mask_subsets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.subset_utils.sample_subsets" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sample_subsets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;toma
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" toma">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_call" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_generate" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_generate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icx360.utils.toma.toma_get_probs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toma_get_probs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API reference</h1>
<p>This is an automatically generated API reference of the ICX360 toolkit.</p>


<div class="doc doc-object doc-module">



<h2 id="icx360" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">icx360</span>


</h2>

    <div class="doc doc-contents first">






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            algorithms (icx360.algorithms)" href="#icx360.algorithms">algorithms</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing submodules for MExGen, CELL, and Token Highlighter explainers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            metrics (icx360.metrics)" href="#icx360.metrics">metrics</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing metrics for explanations</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            utils (icx360.utils)" href="#icx360.utils">utils</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing various utilities including model wrappers, infillers, scalarizers, and segmenters, among others</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="icx360.algorithms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">algorithms</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module containing submodules for MExGen, CELL, and Token Highlighter explainers</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            cell (icx360.algorithms.cell)" href="#icx360.algorithms.cell">cell</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing CELL and mCELL submodules</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            lbbe (icx360.algorithms.lbbe)" href="#icx360.algorithms.lbbe">lbbe</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing base class for local black box explainers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            lwbe (icx360.algorithms.lwbe)" href="#icx360.algorithms.lwbe">lwbe</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing base class for local white box explainers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mexgen (icx360.algorithms.mexgen)" href="#icx360.algorithms.mexgen">mexgen</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing submodules for MExGen C-LIME and MExGen L-SHAP explainers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            token_highlighter (icx360.algorithms.token_highlighter)" href="#icx360.algorithms.token_highlighter">token_highlighter</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing TokenHighlighter submodule (thllm)</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="icx360.algorithms.cell" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">cell</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing CELL and mCELL submodules</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            CELL (icx360.algorithms.cell.CELL)" href="#icx360.algorithms.cell.CELL">CELL</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class CELL</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mCELL (icx360.algorithms.cell.mCELL)" href="#icx360.algorithms.cell.mCELL">mCELL</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class mCELL</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.algorithms.cell.CELL" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">CELL</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class CELL</p>
<p>CELL is an explainer class that contains function explain_instance that
provides contrastive explanations of input instances. The algorithm for
providing explanations is described as CELL in: CELL your Model: Contrastive
Explanations for Large Language Models, Ronny Luss, Erik Miehling, Amit
Dhurandhar. https://arxiv.org/abs/2406.11785</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            CELL (icx360.algorithms.cell.CELL.CELL)" href="#icx360.algorithms.cell.CELL.CELL">CELL</a></code></b>
          –
          <div class="doc-md-description">
            <p>Instances of CELL contain information about the LLM model being explained.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.algorithms.cell.CELL.CELL" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CELL</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CELL</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">infiller</span><span class="o">=</span><span class="s1">&#39;bart&#39;</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scalarizer</span><span class="o">=</span><span class="s1">&#39;shp&#39;</span><span class="p">,</span> <span class="n">scalarizer_model_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scalarizer_type</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">generation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            LocalBBExplainer (icx360.algorithms.lbbe.LocalBBExplainer)" href="#icx360.algorithms.lbbe.LocalBBExplainer">LocalBBExplainer</a></code></p>


        <p>Instances of CELL contain information about the LLM model being explained.
These instances are used to explain LLM responses on input text using a
budgeted algorithm with intelligent search strategy.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._model">_model</span></code></b>
          –
          <div class="doc-md-description">
            <p>model that we want to explain (based on
icx360/utils/model_wrappers)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._infiller">_infiller</span></code></b>
          –
          <div class="doc-md-description">
            <p>string for function used to input text with a mask token and
    output text with mask replaced by text</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._num_return_sequences">_num_return_sequences</span></code></b>
          –
          <div class="doc-md-description">
            <p>integer number of sequences returned when doing
generation for mask infilling</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._scalarizer_name">_scalarizer_name</span></code></b>
          –
          <div class="doc-md-description">
            <p>string of scalarizer to use to determine if a
contrast is found (must be from ['shp', 'nli', 'bleu']</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._scalarizer_type">_scalarizer_type</span></code></b>
          –
          <div class="doc-md-description">
            <p>string specifying either 'distance' for explaining
LLM generation using distances or 'classifier' for explaining a
classifier</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._scalarizer_func">_scalarizer_func</span></code></b>
          –
          <div class="doc-md-description">
            <p>function used to do scalarization from
icx360/utils/scalarizers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._generation">_generation</span></code></b>
          –
          <div class="doc-md-description">
            <p>boolean specifying whether the model being explained
performs true generation (as opposed to having output==input
for classification)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.CELL.CELL._device">_device</span></code></b>
          –
          <div class="doc-md-description">
            <p>string detailing device on which to perform all operations
(must be from ['cpu', 'cuda', 'mps']). should be same as model
being explained</p>
          </div>
        </li>
    </ul>

        <p>Initialize contrastive explainer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
          –
          <div class="doc-md-description">
            <p>model that we want to explain (based on
icx360/utils/model_wrappers)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>infiller</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;bart&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>selects function used to input text with a mask
token and output text with mask replaced by text</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_return_sequences</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>number of sequences returned when
doing generation for mask infilling</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;shp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>select which scalarizer to use to determine
if a contrast is found (must be from ['shp', 'nli', 'bleu'])</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer_model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>allow user to pass a model path for
scalarizers (e.g., choose 'stanfordnlp/SteamSHP-flan-t5-xl'
instead of default 'stanfordnlp/SteamSHP-flan-t5-large')</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;distance&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>'distance' for explaining LLM generation
using distances, 'classifier' for explaining a classifier</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generation</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>the model being explained performs true
generation (as opposed to having output==input)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>experiment_id</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;id&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>passed to evaluate.load for certain
scalarizers. This is used if several distributed
evaluations share the same file system.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform all operations (must be
from ['cpu', 'cuda', 'mps']). should be same as model being
explained</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance (icx360.algorithms.cell.CELL.CELL.explain_instance)" href="#icx360.algorithms.cell.CELL.CELL.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Provide explanations of LLM applied to prompt input_text.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            sample (icx360.algorithms.cell.CELL.CELL.sample)" href="#icx360.algorithms.cell.CELL.CELL.sample">sample</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate sample prompts based on an input prompt</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.cell.CELL.CELL.set_params)" href="#icx360.algorithms.cell.CELL.CELL.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            splitTextByK (icx360.algorithms.cell.CELL.CELL.splitTextByK)" href="#icx360.algorithms.cell.CELL.CELL.splitTextByK">splitTextByK</a></code></b>
            –
            <div class="doc-md-description">
              <p>Split text into words.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.CELL.CELL.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">epsilon_contrastive</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">split_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">budget</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_text_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">prompt_format</span><span class="o">=</span><span class="s1">&#39;Context: $$input0$$ </span><span class="se">\n\n</span><span class="s1">Question: $$input1$$ </span><span class="se">\n\n</span><span class="s1">Answer: &#39;</span><span class="p">,</span> <span class="n">multiple_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_inds_modify</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Provide explanations of LLM applied to prompt input_text.</p>
<p>Provide a contrastive explanation by changing prompt input_text such
that the new prompt generates a response that is preferred as a
response to input_text much less by a certain amount. This metric can
be changed based on user needs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_text</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>input prompt to model that we want to explain</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>epsilon_contrastive</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>amount of change in response to deem a
contrastive explanation</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>split_k</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>number of words to be split into each token that is
masked together</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>budget</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>100</code>
)
          –
          <div class="doc-md-description">
            <p>maximum number of queries allowed from infilling model</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>radius</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>5</code>
)
          –
          <div class="doc-md-description">
            <p>radius for sampling near a previously modified token</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>tradeoff between exploration and exploitation. lower
alpha mean more exploration, higher alpha means more
exploitation</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>True if to print output information, False otherwise</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ir</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>True if to do input reduction, i.e., remove tokens that
cause minimal change to response until a large change occurs</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_text_list</code></b>
              (<code>str list</code>, default:
                  <code>[&#39;&#39;]</code>
)
          –
          <div class="doc-md-description">
            <p>if multiple_inputs==True, then use
input_text_list to feed additional text segments</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>prompt_format</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;Context: $$input0$$ \n\nQuestion: $$input1$$ \n\nAnswer: &#39;</code>
)
          –
          <div class="doc-md-description">
            <p>format for prompt to create from input_text
and input_text_list. Default is question/answering for
google/flan-t5-large</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>multiple_inputs</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>True if example requires multiple inputs
and a format, i.e., uses input_text and input_text_list, False
if just input_text for prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_inds_modify</code></b>
              (<code>int list</code>, default:
                  <code>[0]</code>
)
          –
          <div class="doc-md-description">
            <p>list of which input_text segments to
modify for contrastive example when multiple_inputs==True</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_params</code></b>
              (<code><span title="dico">dico</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>additional keyword arguments for model
generation (self._model.generate())</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>result</code></b> (              <code><span title="dico">dico</span></code>
)          –
          <div class="doc-md-description">
            <p>contains various pieces of contrastive explanation
including contrastive prompt, response to the contrastive
prompt, response to the input prompt, and which words were
modified</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.CELL.CELL.sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample</span><span class="p">(</span><span class="n">input_sample</span><span class="p">,</span> <span class="n">curr_position</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate sample prompts based on an input prompt</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_sample</code></b>
              (<code><span title="dico">dico</span></code>)
          –
          <div class="doc-md-description">
            <p>contains information about a prompt including
text and how it differs from the input prompt to the explainer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>curr_position</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>position of tokens from which to generate
samples within a radius of</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>radius</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>radius for sampling near a previously modified token</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_samples</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>number of samples to generate</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_params</code></b>
              (<code><span title="dico">dico</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>additional keyword arguments for model
generation (self._model.generate())</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>samples_list</code></b> (              <code>dico list</code>
)          –
          <div class="doc-md-description">
            <p>list of samples which are dictionaries
with same information as input_sample</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.CELL.CELL.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.CELL.CELL.splitTextByK" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">splitTextByK</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">splitTextByK</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Split text into words.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>str</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>string to be split</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>number of consecutive words to keep together</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>grouped_words</code></b> (              <code>str list</code>
)          –
          <div class="doc-md-description">
            <p>list of words which when concatenated
retrieves the input str</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.algorithms.cell.mCELL" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">mCELL</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class mCELL</p>
<p>mCELL is an explainer class that contains function explain_instance that
provides contrastive explanations of input instances. The algorithm for
providing explanations is described as m-Cell in: CELL your Model: Contrastive
Explanations for Large Language Models, Ronny Luss, Erik Miehling, Amit
Dhurandhar. https://arxiv.org/abs/2406.11785</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mCELL (icx360.algorithms.cell.mCELL.mCELL)" href="#icx360.algorithms.cell.mCELL.mCELL">mCELL</a></code></b>
          –
          <div class="doc-md-description">
            <p>mCELL Explainer object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.algorithms.cell.mCELL.mCELL" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">mCELL</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mCELL</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">infiller</span><span class="o">=</span><span class="s1">&#39;bart&#39;</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scalarizer</span><span class="o">=</span><span class="s1">&#39;shp&#39;</span><span class="p">,</span> <span class="n">scalarizer_model_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scalarizer_type</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">generation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            LocalBBExplainer (icx360.algorithms.lbbe.LocalBBExplainer)" href="#icx360.algorithms.lbbe.LocalBBExplainer">LocalBBExplainer</a></code></p>


        <p>mCELL Explainer object.</p>
<p>Instances of mCELL contain information about the LLM model being explained.
These instances are used to explain LLM responses on input text using a
myopic algorithm.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._model">_model</span></code></b>
          –
          <div class="doc-md-description">
            <p>model that we want to explain (based on
icx360/utils/model_wrappers)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._infiller">_infiller</span></code></b>
          –
          <div class="doc-md-description">
            <p>string for function used to input text with a mask token and
output text with mask replaced by text</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._num_return_sequences">_num_return_sequences</span></code></b>
          –
          <div class="doc-md-description">
            <p>integer number of sequences returned when doing
generation for mask infilling</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._scalarizer_name">_scalarizer_name</span></code></b>
          –
          <div class="doc-md-description">
            <p>string of scalarizer to use to determine if a
contrast is found (must be from ['shp', 'nli', 'bleu']</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._scalarizer_type">_scalarizer_type</span></code></b>
          –
          <div class="doc-md-description">
            <p>string specifying either 'distance' for explaining
LLM generation using distances or 'classifier' for explaining a
classifier</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._scalarizer_func">_scalarizer_func</span></code></b>
          –
          <div class="doc-md-description">
            <p>function used to do scalarization from
icx360/utils/scalarizers</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._generation">_generation</span></code></b>
          –
          <div class="doc-md-description">
            <p>boolean specifying whether the model being explained
performs true generation (as opposed to having output==input
for classification)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.algorithms.cell.mCELL.mCELL._device">_device</span></code></b>
          –
          <div class="doc-md-description">
            <p>string detailing device on which to perform all operations
(must be from ['cpu', 'cuda', 'mps']). should be same as model
being explained</p>
          </div>
        </li>
    </ul>

        <p>Initialize contrastive explainer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
          –
          <div class="doc-md-description">
            <p>model that we want to explain (based on
icx360/utils/model_wrappers)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>infiller</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;bart&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>selects function used to input text with a mask
token and output text with mask replaced by text</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_return_sequences</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>number of sequences returned
when doing generation for mask infilling</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;shp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>select which scalarizer to use to determine
if a contrast is found (must be from ['shp', 'nli',
'bleu', 'implicit_hate', 'stigma'])</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer_model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>allow user to pass a model path for</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;distance&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>'distance' for explaining LLM generation
using distances, 'classifier' for explaining a classifier</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generation</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>the model being explained performs true
generation (as opposed to having output==input)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>experiment_id</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;id&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>passed to evaluate.load for certain
scalarizers. This is used if several distributed evaluations
share the same file system.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform all operations (must be
from ['cpu', 'cuda', 'mps']). should be same as model being
explained</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance (icx360.algorithms.cell.mCELL.mCELL.explain_instance)" href="#icx360.algorithms.cell.mCELL.mCELL.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Provide explanations of large language model applied to prompt input_text</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.cell.mCELL.mCELL.set_params)" href="#icx360.algorithms.cell.mCELL.mCELL.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            splitTextByK (icx360.algorithms.cell.mCELL.mCELL.splitTextByK)" href="#icx360.algorithms.cell.mCELL.mCELL.splitTextByK">splitTextByK</a></code></b>
            –
            <div class="doc-md-description">
              <p>Split text into words.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.mCELL.mCELL.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">epsilon_contrastive</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon_iter</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">split_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_change_max_iters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Provide explanations of large language model applied to prompt input_text</p>
<p>Provide a contrastive explanation by changing prompt input_text such
that the new prompt generates a response that is preferred as a
response to input_text much less by a certain amount. This metric can
be changed based on user needs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_text</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>input prompt to model that we want to explain</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>epsilon_contrastive</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>amount of change in response to deem
a contrastive explanation</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>epsilon_iter</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.001</code>
)
          –
          <div class="doc-md-description">
            <p>minimum amount of change between iterations
to continue search</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>split_k</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>number of words to be split into each token that
is masked together</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="boolean">boolean</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>True if to print output information, False
otherwise</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ir</code></b>
              (<code><span title="boolean">boolean</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>True if to do input reduction, i.e., remove tokens
that cause minimal change to response until a large change
occurs</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>result</code></b> (              <code><span title="dico">dico</span></code>
)          –
          <div class="doc-md-description">
            <p>contains various pieces of contrastive explanation
including contrastive prompt, response to the contrastive
prompt, response to the input prompt, and which words were
modified</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.mCELL.mCELL.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.cell.mCELL.mCELL.splitTextByK" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">splitTextByK</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">splitTextByK</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Split text into words.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>str</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>string to be split</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>number of consecutive words to keep together</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>grouped_words</code></b> (              <code>str list</code>
)          –
          <div class="doc-md-description">
            <p>list of words which when concatenated
retrieves the input str</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.algorithms.lbbe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">lbbe</span>


</h4>

    <div class="doc doc-contents ">

        <p>File containing base class for local black box explainers</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            ABC


  
      module-attribute
   (icx360.algorithms.lbbe.ABC)" href="#icx360.algorithms.lbbe.ABC">ABC</a></code></b>
          –
          <div class="doc-md-description">
            <p>Ensure compatibility of Abstract Base Class with Python versions</p>
          </div>
        </li>
    </ul>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            LocalBBExplainer (icx360.algorithms.lbbe.LocalBBExplainer)" href="#icx360.algorithms.lbbe.LocalBBExplainer">LocalBBExplainer</a></code></b>
          –
          <div class="doc-md-description">
            <p>LocalBBExplainer is the base class for local post-hoc black-box explainers (LBBE).</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="icx360.algorithms.lbbe.ABC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ABC</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ABC</span> <span class="o">=</span> <span class="n"><span title="abc.ABC">ABC</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<div class="doc doc-object doc-class">



<h5 id="icx360.algorithms.lbbe.LocalBBExplainer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LocalBBExplainer</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">LocalBBExplainer</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            ABC


  
      module-attribute
   (icx360.algorithms.lbbe.ABC)" href="#icx360.algorithms.lbbe.ABC">ABC</a></code></p>


        <p>LocalBBExplainer is the base class for local post-hoc black-box explainers (LBBE).
Such explainers are model agnostic and generally require access to model's predict function alone.
Examples include LIME[#1]<em>, SHAP[#2]</em>, etc..</p>


<details class="references" open>
  <summary>References</summary>
  <p>.. [#1] “Why Should I Trust You?” Explaining the Predictions of Any Classifier, ACM SIGKDD 2016.
Marco Tulio Ribeiro, Sameer Singh, Carlos Guestrin. https://arxiv.org/abs/1602.04938.
.. [#2] A Unified Approach to Interpreting Model Predictions, NIPS 2017.
Lundberg, Scott M and Lee, Su-In. https://arxiv.org/abs/1705.07874</p>
</details>
        <p>Initialize a LocalBBExplainer object.</p>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance


  
      abstractmethod
   (icx360.algorithms.lbbe.LocalBBExplainer.explain_instance)" href="#icx360.algorithms.lbbe.LocalBBExplainer.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Explain an input instance x.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.lbbe.LocalBBExplainer.set_params)" href="#icx360.algorithms.lbbe.LocalBBExplainer.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.lbbe.LocalBBExplainer.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Explain an input instance x.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.lbbe.LocalBBExplainer.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.algorithms.lwbe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">lwbe</span>


</h4>

    <div class="doc doc-contents ">

        <p>File containing base class for local white box explainers</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            ABC


  
      module-attribute
   (icx360.algorithms.lwbe.ABC)" href="#icx360.algorithms.lwbe.ABC">ABC</a></code></b>
          –
          <div class="doc-md-description">
            <p>Ensure compatibility of Abstract Base Class with Python versions</p>
          </div>
        </li>
    </ul>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            LocalWBExplainer (icx360.algorithms.lwbe.LocalWBExplainer)" href="#icx360.algorithms.lwbe.LocalWBExplainer">LocalWBExplainer</a></code></b>
          –
          <div class="doc-md-description">
            <p>LocalWBExplainer is the base class for local post-hoc white box explainers (LWBE).</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="icx360.algorithms.lwbe.ABC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ABC</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ABC</span> <span class="o">=</span> <span class="n"><span title="abc.ABC">ABC</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<div class="doc doc-object doc-class">



<h5 id="icx360.algorithms.lwbe.LocalWBExplainer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LocalWBExplainer</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">LocalWBExplainer</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            ABC


  
      module-attribute
   (icx360.algorithms.lwbe.ABC)" href="#icx360.algorithms.lwbe.ABC">ABC</a></code></p>


        <p>LocalWBExplainer is the base class for local post-hoc white box explainers (LWBE).
Such explainers generally require access to model's internals beyond its predict function.
Examples include Contrastive explanation method[#1]<em>, Layer-wise Relevance Propagation[#2]</em>, etc.</p>


<details class="references" open>
  <summary>References</summary>
  <p>.. [#] Explanations based on the Missing: Towards Contrastive Explanations with Pertinent Negatives,
   NIPS, 2018. Amit Dhurandhar, Pin-Yu Chen, Ronny Luss, Chun-Chen Tu,
   Paishun Ting, Karthikeyan Shanmugam, Payel Das. https://arxiv.org/abs/1802.07623
.. [#2] http://www.heatmapping.org/</p>
</details>
        <p>Constructor method, initialize a LocalWBExplainer object.</p>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance


  
      abstractmethod
   (icx360.algorithms.lwbe.LocalWBExplainer.explain_instance)" href="#icx360.algorithms.lwbe.LocalWBExplainer.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Explain an input instance x.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.lwbe.LocalWBExplainer.set_params)" href="#icx360.algorithms.lwbe.LocalWBExplainer.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.lwbe.LocalWBExplainer.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Explain an input instance x.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.lwbe.LocalWBExplainer.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.algorithms.mexgen" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">mexgen</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing submodules for MExGen C-LIME and MExGen L-SHAP explainers</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            clime (icx360.algorithms.mexgen.clime)" href="#icx360.algorithms.mexgen.clime">clime</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class and supporting functions for MExGen C-LIME explainer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            lshap (icx360.algorithms.mexgen.lshap)" href="#icx360.algorithms.mexgen.lshap">lshap</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class and supporting functions for MExGen L-SHAP explainer.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.algorithms.mexgen.clime" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">clime</span>


</h5>

    <div class="doc doc-contents ">

        <p>Class and supporting functions for MExGen C-LIME explainer.</p>


<details class="the-mexgen-framework-and-c-lime-algorithm-are-described-in" open>
  <summary>The MExGen framework and C-LIME algorithm are described in</summary>
  <p>Multi-Level Explanations for Generative Language Models.
Lucas Monteiro Paes and Dennis Wei et al.
The 63rd Annual Meeting of the Association for Computational Linguistics (ACL 2025).
https://arxiv.org/abs/2403.14459</p>
</details>







<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            CLIME (icx360.algorithms.mexgen.clime.CLIME)" href="#icx360.algorithms.mexgen.clime.CLIME">CLIME</a></code></b>
          –
          <div class="doc-md-description">
            <p>MExGen C-LIME explainer</p>
          </div>
        </li>
    </ul>




<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_linear_model_features (icx360.algorithms.mexgen.clime.compute_linear_model_features)" href="#icx360.algorithms.mexgen.clime.compute_linear_model_features">compute_linear_model_features</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute features used by explanatory linear model.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            fit_linear_model (icx360.algorithms.mexgen.clime.fit_linear_model)" href="#icx360.algorithms.mexgen.clime.fit_linear_model">fit_linear_model</a></code></b>
            –
            <div class="doc-md-description">
              <p>Fit explanatory linear model.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.algorithms.mexgen.clime.CLIME" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CLIME</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CLIME</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">segmenter</span><span class="o">=</span><span class="s1">&#39;en_core_web_trf&#39;</span><span class="p">,</span> <span class="n">scalarizer</span><span class="o">=</span><span class="s1">&#39;prob&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            LocalBBExplainer (icx360.algorithms.lbbe.LocalBBExplainer)" href="#icx360.algorithms.lbbe.LocalBBExplainer">LocalBBExplainer</a></code></p>


        <p>MExGen C-LIME explainer</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.algorithms.mexgen.clime.CLIME.model)" href="#icx360.algorithms.mexgen.clime.CLIME.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            segmenter


  
      instance-attribute
   (icx360.algorithms.mexgen.clime.CLIME.segmenter)" href="#icx360.algorithms.mexgen.clime.CLIME.segmenter">segmenter</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></code>)
          –
          <div class="doc-md-description">
            <p>Object for segmenting input text into units using a spaCy model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            scalarized_model


  
      instance-attribute
   (icx360.algorithms.mexgen.clime.CLIME.scalarized_model)" href="#icx360.algorithms.mexgen.clime.CLIME.scalarized_model">scalarized_model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code>)
          –
          <div class="doc-md-description">
            <p>"Scalarized model" that further wraps <code>model</code> with a method for computing scalar values
based on the model's inputs or outputs.</p>
          </div>
        </li>
    </ul>

        <p>Initialize MExGen C-LIME explainer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segmenter</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;en_core_web_trf&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of spaCy model to use in segmenter (icx360.utils.segmenters.SpaCySegmenter).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;prob&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of scalarizer to use.
    "prob": probability of generating original output conditioned on perturbed inputs
        (instantiates an icx360.utils.scalarizers.ProbScalarizedModel).
    "text": similarity scores between original output and perturbed outputs
        (instantiates an icx360.utils.scalarizers.TextScalarizedModel).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for initializing scalarizer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If <code>scalarizer</code> is not "prob" or "text".</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance (icx360.algorithms.mexgen.clime.CLIME.explain_instance)" href="#icx360.algorithms.mexgen.clime.CLIME.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Explain model output by attributing it to parts of the input text.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.mexgen.clime.CLIME.set_params)" href="#icx360.algorithms.mexgen.clime.CLIME.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.clime.CLIME.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.mexgen.clime.CLIME(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.clime.CLIME.scalarized_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">scalarized_model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">scalarized_model</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProbScalarizedModel (icx360.utils.scalarizers.ProbScalarizedModel)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel">ProbScalarizedModel</a></span><span class="p">(</span><span class="n"><span title="icx360.algorithms.mexgen.clime.CLIME(model)">model</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.clime.CLIME.segmenter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">segmenter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">segmenter</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></span><span class="p">(</span><span class="n"><span title="icx360.algorithms.mexgen.clime.CLIME(segmenter)">segmenter</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.mexgen.clime.CLIME.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="n">input_orig</span><span class="p">,</span> <span class="n">unit_types</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">ind_segment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">segment_type</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">scalarize_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">oversampling_factor</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_units_replace</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">empty_subset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replacement_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">num_nonzeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Explain model output by attributing it to parts of the input text.</p>
<p>Uses an algorithm called C-LIME (a variant of LIME)
to fit a local linear approximation to the model and compute attribution scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_orig</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>[input] Input text as a single unit (if str) or segmented sequence of units (List[str]).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit_types</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>]</code>, default:
                  <code>&#39;p&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[input] Types of units in input_orig.
    "p" for paragraph, "s" for sentence, "w" for word,
    "n" for not to be perturbed/attributed to.
If str, applies to all units in input_orig, otherwise unit-specific.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ind_segment</code></b>
              (<code><span title="bool">bool</span> or <span title="List">List</span>[<span title="bool">bool</span>]</code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Whether to segment input text.
If bool, applies to all units; if List[bool], applies to each unit individually.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segment_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;s&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Type of units to segment into: "s" for sentences, "w" for words, "ph" for phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Maximum phrase length in terms of spaCy tokens (default 10).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model generation (for the self.model.generate() method).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarize_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for computing scalar outputs
(for the self.scalarized_model.scalarize_output() method).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>oversampling_factor</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] Ratio of number of perturbed inputs to be generated to number of units that can be perturbed.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_units_replace</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] Maximum number of units to perturb at one time (default 2).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>empty_subset</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] Whether to include empty subset of units to perturb (default True).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>replacement_str</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] String to replace units with (default "" for dropping units).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_nonzeros</code></b>
              (<code><span title="int">int</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>[linear model] Number of non-zero coefficients in linear model (default None means dense model).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>debias</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>[linear model] Refit linear model with no penalty after selecting features (default True).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_dict</code></b> (              <code><span title="dict">dict</span></code>
)          –
          <div class="doc-md-description">
            <p>Dictionary with the following items:
    "attributions" (dict):
        Dictionary with attribution scores, corresponding input units, and unit types.
    "output_orig" (icx360.utils.model_wrappers.GeneratedOutput):
        Output object generated from original input.
    "intercept" (float or dict[float]):
        Intercept(s) of linear model.</p>
<p>Items in "attributions" dictionary:
    "units" (List[str]):
        input_orig segmented into units if not already, otherwise same as original.
    "unit_types" (List[str]):
        Types of units.
    <code>score_label</code> ((num_units,) np.ndarray):
        One or more sets of attribution scores (labelled by the type of scalarizer).</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.mexgen.clime.CLIME.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.mexgen.clime.compute_linear_model_features" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_linear_model_features</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_linear_model_features</span><span class="p">(</span><span class="n">subsets_replace</span><span class="p">,</span> <span class="n">num_units</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute features used by explanatory linear model.</p>
<p>This function generates a feature matrix for a linear model that explains
the impact of perturbing specific input units.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>subsets_replace</code></b>
              (<code><span title="List">List</span>[<span title="List">List</span>[<span title="int">int</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A list of subsets, where each subset is a list of indices
corresponding to the units that have been replaced.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_units</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Total number of units.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>features</code></b> (              <code>(num_perturb, num_units) np.ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Matrix of feature values,
equal to 1 if the unit is part of the perturbed subset, and 0 otherwise.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.mexgen.clime.fit_linear_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">fit_linear_model</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fit_linear_model</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">sample_weights</span><span class="p">,</span> <span class="n">num_nonzeros</span><span class="p">,</span> <span class="n">debias</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fit explanatory linear model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>features</code></b>
              (<code>num_perturb, num_units) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Feature values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>target</code></b>
              (<code>num_perturb,) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Target values to predict.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sample_weights</code></b>
              (<code>num_perturb,) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Sample weights.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_nonzeros</code></b>
              (<code><span title="int">int</span> or None</code>)
          –
          <div class="doc-md-description">
            <p>Number of non-zero coefficients desired in linear model, None means dense model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>debias</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Refit linear model with no penalty after selecting features.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>coef</code></b> (              <code>(num_units,) np.ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Coefficients of linear model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>intercept</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>Intercept of linear model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>num_nonzeros</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>Actual number of non-zero coefficients.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.algorithms.mexgen.lshap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">lshap</span>


</h5>

    <div class="doc doc-contents ">

        <p>Class and supporting functions for MExGen L-SHAP explainer.</p>


<details class="the-mexgen-framework-and-l-shap-algorithm-are-described-in" open>
  <summary>The MExGen framework and L-SHAP algorithm are described in</summary>
  <p>Multi-Level Explanations for Generative Language Models.
Lucas Monteiro Paes and Dennis Wei et al.
The 63rd Annual Meeting of the Association for Computational Linguistics (ACL 2025).
https://arxiv.org/abs/2403.14459</p>
</details>







<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            LSHAP (icx360.algorithms.mexgen.lshap.LSHAP)" href="#icx360.algorithms.mexgen.lshap.LSHAP">LSHAP</a></code></b>
          –
          <div class="doc-md-description">
            <p>MExGen L-SHAP explainer</p>
          </div>
        </li>
    </ul>




<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            adapt_replacement_set (icx360.algorithms.mexgen.lshap.adapt_replacement_set)" href="#icx360.algorithms.mexgen.lshap.adapt_replacement_set">adapt_replacement_set</a></code></b>
            –
            <div class="doc-md-description">
              <p>Adapt set of units that can be replaced to the unit of interest.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_normalization_constants (icx360.algorithms.mexgen.lshap.get_normalization_constants)" href="#icx360.algorithms.mexgen.lshap.get_normalization_constants">get_normalization_constants</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes normalization constants for Shapley value calculation.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.algorithms.mexgen.lshap.LSHAP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LSHAP</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">LSHAP</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">segmenter</span><span class="o">=</span><span class="s1">&#39;en_core_web_trf&#39;</span><span class="p">,</span> <span class="n">scalarizer</span><span class="o">=</span><span class="s1">&#39;prob&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            LocalBBExplainer (icx360.algorithms.lbbe.LocalBBExplainer)" href="#icx360.algorithms.lbbe.LocalBBExplainer">LocalBBExplainer</a></code></p>


        <p>MExGen L-SHAP explainer</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.algorithms.mexgen.lshap.LSHAP.model)" href="#icx360.algorithms.mexgen.lshap.LSHAP.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            segmenter


  
      instance-attribute
   (icx360.algorithms.mexgen.lshap.LSHAP.segmenter)" href="#icx360.algorithms.mexgen.lshap.LSHAP.segmenter">segmenter</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></code>)
          –
          <div class="doc-md-description">
            <p>Object for segmenting input text into units using a spaCy model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            scalarized_model


  
      instance-attribute
   (icx360.algorithms.mexgen.lshap.LSHAP.scalarized_model)" href="#icx360.algorithms.mexgen.lshap.LSHAP.scalarized_model">scalarized_model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code>)
          –
          <div class="doc-md-description">
            <p>"Scalarized model" that further wraps <code>model</code> with a method for computing scalar values
based on the model's inputs or outputs.</p>
          </div>
        </li>
    </ul>

        <p>Initialize MExGen L-SHAP explainer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segmenter</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;en_core_web_trf&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of spaCy model to use in segmenter (icx360.utils.segmenters.SpaCySegmenter).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;prob&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of scalarizer to use.
    "prob": probability of generating original output conditioned on perturbed inputs
        (instantiates an icx360.utils.scalarizers.ProbScalarizedModel).
    "text": similarity scores between original output and perturbed outputs
        (instantiates an icx360.utils.scalarizers.TextScalarizedModel).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for initializing scalarizer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If <code>scalarizer</code> is not "prob" or "text".</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance (icx360.algorithms.mexgen.lshap.LSHAP.explain_instance)" href="#icx360.algorithms.mexgen.lshap.LSHAP.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Explain model output by attributing it to parts of the input text.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.mexgen.lshap.LSHAP.set_params)" href="#icx360.algorithms.mexgen.lshap.LSHAP.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.lshap.LSHAP.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.mexgen.lshap.LSHAP(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.lshap.LSHAP.scalarized_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">scalarized_model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">scalarized_model</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProbScalarizedModel (icx360.utils.scalarizers.ProbScalarizedModel)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel">ProbScalarizedModel</a></span><span class="p">(</span><span class="n"><span title="icx360.algorithms.mexgen.lshap.LSHAP(model)">model</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.mexgen.lshap.LSHAP.segmenter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">segmenter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">segmenter</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></span><span class="p">(</span><span class="n"><span title="icx360.algorithms.mexgen.lshap.LSHAP(segmenter)">segmenter</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.mexgen.lshap.LSHAP.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="n">input_orig</span><span class="p">,</span> <span class="n">unit_types</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">ind_interest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ind_segment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">segment_type</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">scalarize_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_units_replace</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">replacement_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Explain model output by attributing it to parts of the input text.</p>
<p>Uses an algorithm called L-SHAP (a variant of SHAP)
that computes approximate Shapley values as attribution scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_orig</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>[input] Input text as a single unit (if str) or segmented sequence of units (List[str]).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit_types</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>]</code>, default:
                  <code>&#39;p&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[input] Types of units in input_orig.
    "p" for paragraph, "s" for sentence, "w" for word,
    "n" for not to be perturbed/attributed to.
If str, applies to all units in input_orig, otherwise unit-specific.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ind_interest</code></b>
              (<code><span title="bool">bool</span> or <span title="List">List</span>[<span title="bool">bool</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>[input] Indicator of units to attribute to ("of interest").
Default None means np.array(unit_types) != "n".</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ind_segment</code></b>
              (<code><span title="bool">bool</span> or <span title="List">List</span>[<span title="bool">bool</span>]</code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Whether to segment input text.
If bool, applies to all units; if List[bool], applies to each unit individually.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segment_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;s&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Type of units to segment into: "s" for sentences, "w" for words, "ph" for phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>[segmentation] Maximum phrase length in terms of spaCy tokens (default 10).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model generation (for the self.model.generate() method).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarize_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for computing scalar outputs
(for the self.scalarized_model.scalarize_output() method).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_neighbors</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] Number of neighbors on either side of unit of interest that can be perturbed.
Default 2 (as an example) means two neighbors to the left AND two neighbors to the right.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_units_replace</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] Maximum number of units to perturb at one time (default 2).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>replacement_str</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>[perturbation] String to replace units with (default "" for dropping units).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_dict</code></b> (              <code><span title="dict">dict</span></code>
)          –
          <div class="doc-md-description">
            <p>Dictionary with the following items:
    "attributions" (dict):
        Dictionary with attribution scores, corresponding input units, and unit types.
    "output_orig" (icx360.utils.model_wrappers.GeneratedOutput):
        Output object generated from original input.</p>
<p>Items in "attributions" dictionary:
    "units" (List[str]):
        input_orig segmented into units if not already, otherwise same as original.
    "unit_types" (List[str]):
        Types of units.
    <code>score_label</code> ((num_units,) np.ndarray):
        One or more sets of attribution scores (labelled by the type of scalarizer).</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.mexgen.lshap.LSHAP.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.mexgen.lshap.adapt_replacement_set" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">adapt_replacement_set</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">adapt_replacement_set</span><span class="p">(</span><span class="n">idx_replace</span><span class="p">,</span> <span class="n">idx_interest</span><span class="p">,</span> <span class="n">num_neighbors</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adapt set of units that can be replaced to the unit of interest.</p>
<p>This function modifies the indices of units that can be replaced to exclude the unit of interest
and include neighbors within a specified range on either side.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx_replace</code></b>
              (<code>np.ndarray of dtype int</code>)
          –
          <div class="doc-md-description">
            <p>Indices of units that can be replaced.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idx_interest</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the unit of interest.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_neighbors</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of neighbors on either side of the unit of interest to include.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>idx_replace_adapted</code></b> (              <code>np.ndarray of dtype int</code>
)          –
          <div class="doc-md-description">
            <p>Adapted version of idx_replace, excluding the unit of interest and including neighbors.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.algorithms.mexgen.lshap.get_normalization_constants" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_normalization_constants</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_normalization_constants</span><span class="p">(</span><span class="n">num_can_replace</span><span class="p">,</span> <span class="n">max_units_replace</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Computes normalization constants for Shapley value calculation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_can_replace</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The total number of units that can be replaced.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_units_replace</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The maximum number of units that can be replaced at one time.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>normalization</code></b> (              <code><span title="numpy.ndarray">ndarray</span></code>
)          –
          <div class="doc-md-description">
            <p>An array of normalization constants.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.algorithms.token_highlighter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">token_highlighter</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing TokenHighlighter submodule (thllm)</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            th_llm (icx360.algorithms.token_highlighter.th_llm)" href="#icx360.algorithms.token_highlighter.th_llm">th_llm</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class for TokenHilighter explainer (TH-LLM).</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.algorithms.token_highlighter.th_llm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">th_llm</span>


</h5>

    <div class="doc doc-contents ">

        <p>Class for TokenHilighter explainer (TH-LLM).
Interpreting LLMs based on the importance analysis of input text units.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            TokenHighlighter (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter">TokenHighlighter</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class for TokenHilighter explainer (TH-LLM).</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TokenHighlighter</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TokenHighlighter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">segmenter</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            LocalWBExplainer (icx360.algorithms.lwbe.LocalWBExplainer)" href="#icx360.algorithms.lwbe.LocalWBExplainer">LocalWBExplainer</a></code></p>


        <p>Class for TokenHilighter explainer (TH-LLM).
Interpreting LLMs based on the importance analysis of input text units.</p>

        <p>Initialize the TH-LLM explainer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
          –
          <div class="doc-md-description">
            <p>The large language model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tokenizer</code></b>
          –
          <div class="doc-md-description">
            <p>The tokenizer object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segmenter</code></b>
          –
          <div class="doc-md-description">
            <p>The segmenter object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>affirmation</code></b>
          –
          <div class="doc-md-description">
            <p>The affirmation sentence template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pooling</code></b>
          –
          <div class="doc-md-description">
            <p>The aggregation method ("norm_mean", "mean_norm", or "matrix").</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance">explain_instance</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute importance scores for each text unit.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance_matrix (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_matrix)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_matrix">explain_instance_matrix</a></code></b>
            –
            <div class="doc-md-description">
              <p>Use the Frobenius norm of the token gradient matrix as the importance score for each unit.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance_mean_norm (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_mean_norm)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_mean_norm">explain_instance_mean_norm</a></code></b>
            –
            <div class="doc-md-description">
              <p>Use the average of the L2 norms of token gradients as the importance score for each unit.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            explain_instance_norm_mean (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_norm_mean)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_norm_mean">explain_instance_norm_mean</a></code></b>
            –
            <div class="doc-md-description">
              <p>Use the L2 norm of the average of token gradients as the importance score for each unit.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            set_params (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.set_params)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.set_params">set_params</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set parameters for the explainer.</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            m


  
      instance-attribute
   (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.m)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.m">m</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            pooling


  
      instance-attribute
   (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.pooling)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.pooling">pooling</a></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            segmenter


  
      instance-attribute
   (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.segmenter)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.segmenter">segmenter</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            tok


  
      instance-attribute
   (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.tok)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.tok">tok</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            token_ids


  
      instance-attribute
   (icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.token_ids)" href="#icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.token_ids">token_ids</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.m" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">m</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.pooling" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pooling</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">pooling</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter(kwargs).get">get</span></span><span class="p">(</span><span class="s1">&#39;pooling&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_norm&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.segmenter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">segmenter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">segmenter</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></span><span class="p">(</span><span class="n"><span title="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter(segmenter)">segmenter</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.tok" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tok</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tok</span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter(tokenizer)">tokenizer</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.token_ids" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">token_ids</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">token_ids</span> <span class="o">=</span> <span class="n"><span title="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter(self)._get_token_ids">_get_token_ids</span></span><span class="p">(</span><span class="n"><span title="prefix">prefix</span></span><span class="p">,</span> <span class="n"><span title="infix">infix</span></span><span class="p">,</span> <span class="n"><span title="affirmation">affirmation</span></span><span class="p">,</span> <span class="n"><span title="suffix">suffix</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance</span><span class="p">(</span><span class="n">input_orig</span><span class="p">,</span> <span class="n">unit_types</span><span class="p">,</span> <span class="n">ind_segment</span><span class="p">,</span> <span class="n">segment_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute importance scores for each text unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_orig</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Original input text.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit_types</code></b>
              (<code><span title="Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Type(s) of each text unit.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ind_segment</code></b>
              (<code><span title="Union">Union</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="bool">bool</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Whether to segment.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segment_type</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Type of segmentation to apply.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Max length allowed for a phrase.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>Dict[str, Any]: Attribution information dictionary.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance_matrix</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance_matrix</span><span class="p">(</span><span class="n">units</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use the Frobenius norm of the token gradient matrix as the importance score for each unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code><span title="typing.List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A list of text units (e.g., phrases or words) that form the prompt.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="float">float</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[List[str], List[float]]: A tuple containing:
- The list of units.
- The unit scores based on Frobenius norms of token gradients.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_mean_norm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance_mean_norm</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance_mean_norm</span><span class="p">(</span><span class="n">units</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use the average of the L2 norms of token gradients as the importance score for each unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code><span title="typing.List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A list of text units (e.g., phrases or words) that form the prompt.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="float">float</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[List[str], List[float]]: A tuple containing:
- The list of units.
- The unit scores based on the mean_norm method.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.explain_instance_norm_mean" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">explain_instance_norm_mean</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explain_instance_norm_mean</span><span class="p">(</span><span class="n">units</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use the L2 norm of the average of token gradients as the importance score for each unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code><span title="typing.List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A list of text units (e.g., phrases or words) that form the prompt.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="float">float</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[List[str], List[float]]: A tuple containing:
- The list of units.
- The unit scores based on the norm_mean method.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.algorithms.token_highlighter.th_llm.TokenHighlighter.set_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_params</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set parameters for the explainer.</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="icx360.metrics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">metrics</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module containing metrics for explanations</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            perturb_curve (icx360.metrics.perturb_curve)" href="#icx360.metrics.perturb_curve">perturb_curve</a></code></b>
          –
          <div class="doc-md-description">
            <p>Perturbation curve evaluator for measuring the fidelity of input attributions to the explained model.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="icx360.metrics.perturb_curve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">perturb_curve</span>


</h4>

    <div class="doc doc-contents ">

        <p>Perturbation curve evaluator for measuring the fidelity of input attributions to the explained model.</p>
<p>The PerturbCurveEvaluator class evaluates perturbation curves for input attribution scores
produced by icx360.algorithms.mexgen.CLIME.explain_instance() or icx360.algorithms.mexgen.LSHAP.explain_instance().
It thus evaluates the fidelity of these attribution scores to the explained model.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            PerturbCurveEvaluator (icx360.metrics.perturb_curve.PerturbCurveEvaluator)" href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator">PerturbCurveEvaluator</a></code></b>
          –
          <div class="doc-md-description">
            <p>Perturbation curve evaluator for measuring the fidelity of input attributions to the explained model.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="icx360.metrics.perturb_curve.PerturbCurveEvaluator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PerturbCurveEvaluator</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">PerturbCurveEvaluator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">scalarizer</span><span class="o">=</span><span class="s1">&#39;prob&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Perturbation curve evaluator for measuring the fidelity of input attributions to the explained model.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.metrics.perturb_curve.PerturbCurveEvaluator.model)" href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            scalarized_model


  
      instance-attribute
   (icx360.metrics.perturb_curve.PerturbCurveEvaluator.scalarized_model)" href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.scalarized_model">scalarized_model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code>)
          –
          <div class="doc-md-description">
            <p>"Scalarized model" that further wraps <code>model</code> with a method for computing scalar values
based on the model's inputs or outputs.</p>
          </div>
        </li>
    </ul>

        <p>Initialize perturbation curve evaluator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Model to explain, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarizer</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;prob&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of scalarizer to use.
    "prob": probability of generating original output conditioned on perturbed inputs
        (instantiates an icx360.utils.scalarizers.ProbScalarizedModel).
    "text": similarity scores between original output and perturbed outputs
        (instantiates an icx360.utils.scalarizers.TextScalarizedModel).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for initializing scalarizer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If <code>scalarizer</code> is not "prob" or "text".</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            eval_perturb_curve (icx360.metrics.perturb_curve.PerturbCurveEvaluator.eval_perturb_curve)" href="#icx360.metrics.perturb_curve.PerturbCurveEvaluator.eval_perturb_curve">eval_perturb_curve</a></code></b>
            –
            <div class="doc-md-description">
              <p>Evaluate perturbation curve for given input attributions.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="icx360.metrics.perturb_curve.PerturbCurveEvaluator.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.metrics.perturb_curve.PerturbCurveEvaluator(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="icx360.metrics.perturb_curve.PerturbCurveEvaluator.scalarized_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">scalarized_model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">scalarized_model</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProbScalarizedModel (icx360.utils.scalarizers.ProbScalarizedModel)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel">ProbScalarizedModel</a></span><span class="p">(</span><span class="n"><span title="icx360.metrics.perturb_curve.PerturbCurveEvaluator(model)">model</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h6 id="icx360.metrics.perturb_curve.PerturbCurveEvaluator.eval_perturb_curve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">eval_perturb_curve</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">eval_perturb_curve</span><span class="p">(</span><span class="n">explainer_dict</span><span class="p">,</span> <span class="n">score_label</span><span class="p">,</span> <span class="n">token_frac</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_frac_perturb</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">replacement_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">model_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">scalarize_params</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Evaluate perturbation curve for given input attributions.</p>
<p>This method evaluates the perturbation curve for a set of attribution scores
by perturbing units in decreasing order of their attribution scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>explainer_dict</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>Attribution dictionary as produced by icx360.algorithms.mexgen.CLIME.explain_instance()
or icx360.algorithms.mexgen.LSHAP.explain_instance().</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>score_label</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Label of the attribution score to use for ranking units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>token_frac</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to consider the number of tokens in each unit when ranking and perturbing units.
Defaults to False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_frac_perturb</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum fraction of units or tokens to perturb. Defaults to 0.5.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>replacement_str</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>String to replace perturbed units with. Defaults to "" for dropping units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model generation (for the self.model.generate() method).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalarize_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for computing scalar outputs
(for the self.scalarized_model.scalarize_output() method).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_perturbed</code></b> (              <code><span title="dict">dict</span></code>
)          –
          <div class="doc-md-description">
            <p>Dictionary with the following items:
    "frac" (torch.Tensor):
        Fractions of units or tokens perturbed.
    <code>score_label</code> (torch.Tensor):
        One or more Tensors of scalarized output values corresponding to the fractions
        in the "frac" Tensor. <code>score_label</code> labels each Tensor with the type of scalarizer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If token_frac is True and model's tokenizer is not available.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="icx360.utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">utils</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module containing various utilities including model wrappers, infillers, scalarizers, and segmenters, among others</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            coloring_utils (icx360.utils.coloring_utils)" href="#icx360.utils.coloring_utils">coloring_utils</a></code></b>
          –
          <div class="doc-md-description">
            <p>Utilities for coloring and displaying units of text.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            general_utils (icx360.utils.general_utils)" href="#icx360.utils.general_utils">general_utils</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing general utility functions</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            infillers (icx360.utils.infillers)" href="#icx360.utils.infillers">infillers</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model_wrappers (icx360.utils.model_wrappers)" href="#icx360.utils.model_wrappers">model_wrappers</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing wrappers for different types of models (used by MExGen and CELL).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            scalarizers (icx360.utils.scalarizers)" href="#icx360.utils.scalarizers">scalarizers</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing scalarizers, which compute scalar output values based on the outputs or inputs of an LLM.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            segmenters (icx360.utils.segmenters)" href="#icx360.utils.segmenters">segmenters</a></code></b>
          –
          <div class="doc-md-description">
            <p>Module containing utilities for segmenting input text into units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            subset_utils (icx360.utils.subset_utils)" href="#icx360.utils.subset_utils">subset_utils</a></code></b>
          –
          <div class="doc-md-description">
            <p>Utilities that deal with subsets of input units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            toma (icx360.utils.toma)" href="#icx360.utils.toma">toma</a></code></b>
          –
          <div class="doc-md-description">
            <p>Model inference utilities that use the toma package to avoid running out of CUDA memory.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="icx360.utils.coloring_utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">coloring_utils</span>


</h4>

    <div class="doc doc-contents ">

        <p>Utilities for coloring and displaying units of text.</p>










<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            color_units (icx360.utils.coloring_utils.color_units)" href="#icx360.utils.coloring_utils.color_units">color_units</a></code></b>
            –
            <div class="doc-md-description">
              <p>Color units of text according to scores and display.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            highlight_text (icx360.utils.coloring_utils.highlight_text)" href="#icx360.utils.coloring_utils.highlight_text">highlight_text</a></code></b>
            –
            <div class="doc-md-description">
              
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            COLOR_LIST_IBM_30


  
      module-attribute
   (icx360.utils.coloring_utils.COLOR_LIST_IBM_30)" href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_30">COLOR_LIST_IBM_30</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            COLOR_LIST_IBM_40


  
      module-attribute
   (icx360.utils.coloring_utils.COLOR_LIST_IBM_40)" href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_40">COLOR_LIST_IBM_40</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="icx360.utils.coloring_utils.COLOR_LIST_IBM_30" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">COLOR_LIST_IBM_30</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">COLOR_LIST_IBM_30</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#a6c8ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#c6c6c6&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffb3b8&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="icx360.utils.coloring_utils.COLOR_LIST_IBM_40" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">COLOR_LIST_IBM_40</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">COLOR_LIST_IBM_40</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#78a9ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#c6c6c6&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff8389&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="icx360.utils.coloring_utils.color_units" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">color_units</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">color_units</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">norm_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            COLOR_LIST_IBM_40


  
      module-attribute
   (icx360.utils.coloring_utils.COLOR_LIST_IBM_40)" href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_40">COLOR_LIST_IBM_40</a></span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Color units of text according to scores and display.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code>num_units,) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Units of text.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scores</code></b>
              (<code>num_units,) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Scores corresponding to units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>norm_factor</code></b>
              (<code><span title="float">float</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Factor to divide scores by to normalize them. None (default) means np.abs(scores).max().</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scale_sqrt</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply square root to magnitude of score</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>color_list</code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>]</code>, default:
                  <code><a class="autorefs autorefs-internal" title="            COLOR_LIST_IBM_40


  
      module-attribute
   (icx360.utils.coloring_utils.COLOR_LIST_IBM_40)" href="#icx360.utils.coloring_utils.COLOR_LIST_IBM_40">COLOR_LIST_IBM_40</a></code>
)
          –
          <div class="doc-md-description">
            <p>List of colors for matplotlib.colors.LinearSegmentedColormap</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>show</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Show on screen if True, otherwise return list of HTML strings.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>colored_units</code></b> (              <code><span title="List">List</span>[<span title="str">str</span>] or None</code>
)          –
          <div class="doc-md-description">
            <p>List of HTML-formatted units of text if show==False, otherwise None.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="icx360.utils.coloring_utils.highlight_text" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">highlight_text</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">highlight_text</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.general_utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">general_utils</span>


</h4>

    <div class="doc doc-contents ">

        <p>File containing general utility functions</p>










<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            fix_seed (icx360.utils.general_utils.fix_seed)" href="#icx360.utils.general_utils.fix_seed">fix_seed</a></code></b>
            –
            <div class="doc-md-description">
              <p>Fix a random seeed for all random number generators (random, numpy, torch)</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            select_device (icx360.utils.general_utils.select_device)" href="#icx360.utils.general_utils.select_device">select_device</a></code></b>
            –
            <div class="doc-md-description">
              <p>Select device on which to perform all operations.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="icx360.utils.general_utils.fix_seed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">fix_seed</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fix_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fix a random seeed for all random number generators (random, numpy, torch)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
          –
          <div class="doc-md-description">
            <p>seed to set for all randomizations</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="icx360.utils.general_utils.select_device" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">select_device</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">select_device</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Select device on which to perform all operations.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>device</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>device on which to perform all operations according
to user system</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.infillers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">infillers</span>


</h4>

    <div class="doc doc-contents ">






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            BART_infiller (icx360.utils.infillers.BART_infiller)" href="#icx360.utils.infillers.BART_infiller">BART_infiller</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class BART_infiller</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            T5_infiller (icx360.utils.infillers.T5_infiller)" href="#icx360.utils.infillers.T5_infiller">T5_infiller</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class T5_infiller</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.utils.infillers.BART_infiller" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">BART_infiller</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class BART_infiller</p>
<p>BART_infiller is used to perform infilling using a BART LLM.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            BART_infiller (icx360.utils.infillers.BART_infiller.BART_infiller)" href="#icx360.utils.infillers.BART_infiller.BART_infiller">BART_infiller</a></code></b>
          –
          <div class="doc-md-description">
            <p>BART_infiller object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.infillers.BART_infiller.BART_infiller" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BART_infiller</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">BART_infiller</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;facebook/bart-large&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>BART_infiller object.</p>
<p>Instances can be used to encode, decode, and generate text to infill
masks in text.</p>
<p>Attributes
    _model: BART model used for infilling
    _tokenizer: BART tokenizer
    mask_string: text that represents a mask for BART
    mask_string_encoded: encoded version of mask for BART
    mask_filled_error: text representing that an infilling error occurred</p>

        <p>Initialize BART infilling object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;facebook/bart-large&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>name of BART model to be used for infilling</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            decode (icx360.utils.infillers.BART_infiller.BART_infiller.decode)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.decode">decode</a></code></b>
            –
            <div class="doc-md-description">
              <p>Function to decode text via BART tokenizer</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            encode (icx360.utils.infillers.BART_infiller.BART_infiller.encode)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.encode">encode</a></code></b>
            –
            <div class="doc-md-description">
              <p>Function to encode text via BART tokenizer</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            generate (icx360.utils.infillers.BART_infiller.BART_infiller.generate)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.generate">generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate text to infill mask tokens. Assumes one of tokens is</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_infilled_mask (icx360.utils.infillers.BART_infiller.BART_infiller.get_infilled_mask)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.get_infilled_mask">get_infilled_mask</a></code></b>
            –
            <div class="doc-md-description">
              <p>Retrieve text that replaced <mask> when infilling from generation</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            similar (icx360.utils.infillers.BART_infiller.BART_infiller.similar)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.similar">similar</a></code></b>
            –
            <div class="doc-md-description">
              <p>Determine if word is similar to fill_in</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_filled_error


  
      instance-attribute
   (icx360.utils.infillers.BART_infiller.BART_infiller.mask_filled_error)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.mask_filled_error">mask_filled_error</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string


  
      instance-attribute
   (icx360.utils.infillers.BART_infiller.BART_infiller.mask_string)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.mask_string">mask_string</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string_encoded


  
      instance-attribute
   (icx360.utils.infillers.BART_infiller.BART_infiller.mask_string_encoded)" href="#icx360.utils.infillers.BART_infiller.BART_infiller.mask_string_encoded">mask_string_encoded</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.mask_filled_error" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_filled_error</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_filled_error</span> <span class="o">=</span> <span class="s1">&#39;!!abcxyz!!&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.mask_string" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string</span> <span class="o">=</span> <span class="s1">&#39;&lt;mask&gt;&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.mask_string_encoded" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string_encoded</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string_encoded</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.infillers.BART_infiller.BART_infiller(self)._tokenizer.encode">encode</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.infillers.BART_infiller.BART_infiller(self).mask_string">mask_string</span></span><span class="p">,</span> <span class="n"><span title="icx360.utils.infillers.BART_infiller.BART_infiller(self)._tokenizer.encode(add_special_tokens)">add_special_tokens</span></span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.decode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">decode</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">decode</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function to decode text via BART tokenizer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>tokens</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>skip_special_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>True if to skip special tokens in
decoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>string frame decoding all input tokens</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.encode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">encode</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function to encode text via BART tokenizer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>text</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>string to encode</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>add_special_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>True if to use special tokens in
encoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>token indices where n is based on input text</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked_word</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">return_mask_filled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate text to infill mask tokens. Assumes one of tokens is
    <mask> which is token id self.mask_string_encoded
Args:
    tokens (int list): token indices
    num_return_sequences (int): number of generations to return
        (default: 1)
    masked_word (str): word that is masked in tokens (default: '')
    return_mask_filled (bool): if true, return (ret, mask_filled),
        else return only ret</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>list of token indices after calling model.generate
on input tokens</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>mask_filled</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>decoded version of infilled texts</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.get_infilled_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_infilled_mask</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_infilled_mask</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">y_enc</span><span class="p">,</span> <span class="n">return_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieve text that replaced <mask> when infilling from generation
    output</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_enc</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices where one token is <mask>, i.e.
input to generation function</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_enc</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices representing same as x_enc with
several tokens replacing <mask>, i.e., output of generation
function</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>if true, return (mask_filled, inds_infill),
else return only mask_filled</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>mask_filled</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>decoded tokens that replace <mask> in y_enc
from x_enc</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>inds_infill</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>token indices representing encoded version
of infilled text</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.BART_infiller.BART_infiller.similar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">similar</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">similar</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">fill_in</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Determine if word is similar to fill_in</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>word</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>words to search for</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>fill_in</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>filled in text to search for word in</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="bool">bool</span></code>
)          –
          <div class="doc-md-description">
            <p>True if word is similar to fill_in, False otherwise</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.infillers.T5_infiller" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">T5_infiller</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class T5_infiller</p>
<p>T5_infiller is used to perform infilling using a T5 LLM.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            T5_infiller (icx360.utils.infillers.T5_infiller.T5_infiller)" href="#icx360.utils.infillers.T5_infiller.T5_infiller">T5_infiller</a></code></b>
          –
          <div class="doc-md-description">
            <p>T5_infiller object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.infillers.T5_infiller.T5_infiller" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">T5_infiller</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">T5_infiller</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;t5-large&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>T5_infiller object.</p>
<p>Instances can be used to encode, decode, and generate text to infill
masks in text.</p>
<p>Attributes
    _model: T5 model used for infilling
    _tokenizer: T5 tokenizer
    mask_string: text that represents beginning of mask for T5
    mask_string_end: text that represent end of mask for T5
    mask_string_encoded: encoded version of mask_string for T5
    mask_string_end_encoded: encoded version of mask_string_end for T5
    mask_filled_error: text representing that an infilling error occurred</p>

        <p>Initialize T5 infilling object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;t5-large&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>name of T5 model to be used for infilling</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            decode (icx360.utils.infillers.T5_infiller.T5_infiller.decode)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.decode">decode</a></code></b>
            –
            <div class="doc-md-description">
              <p>Function to decode text via T5 tokenizer</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            encode (icx360.utils.infillers.T5_infiller.T5_infiller.encode)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.encode">encode</a></code></b>
            –
            <div class="doc-md-description">
              <p>Function to encode text via T5 tokenizer</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            generate (icx360.utils.infillers.T5_infiller.T5_infiller.generate)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.generate">generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate text to infill mask tokens. Assumes one of tokens is</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_infilled_mask (icx360.utils.infillers.T5_infiller.T5_infiller.get_infilled_mask)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.get_infilled_mask">get_infilled_mask</a></code></b>
            –
            <div class="doc-md-description">
              <p>Retrieve text that replaced <extra_id_0>  when infilling from generation</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            similar (icx360.utils.infillers.T5_infiller.T5_infiller.similar)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.similar">similar</a></code></b>
            –
            <div class="doc-md-description">
              <p>Determine if word is similar to fill_in</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_filled_error


  
      instance-attribute
   (icx360.utils.infillers.T5_infiller.T5_infiller.mask_filled_error)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.mask_filled_error">mask_filled_error</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string


  
      instance-attribute
   (icx360.utils.infillers.T5_infiller.T5_infiller.mask_string)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.mask_string">mask_string</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string_encoded


  
      instance-attribute
   (icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_encoded)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_encoded">mask_string_encoded</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string_end


  
      instance-attribute
   (icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end">mask_string_end</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            mask_string_end_encoded


  
      instance-attribute
   (icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end_encoded)" href="#icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end_encoded">mask_string_end_encoded</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.mask_filled_error" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_filled_error</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_filled_error</span> <span class="o">=</span> <span class="s1">&#39;!!abcxyz!!&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.mask_string" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string</span> <span class="o">=</span> <span class="s1">&#39;&lt;extra_id_0&gt;&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_encoded" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string_encoded</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string_encoded</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self)._tokenizer.encode">encode</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self).mask_string">mask_string</span></span><span class="p">,</span> <span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self)._tokenizer.encode(add_special_tokens)">add_special_tokens</span></span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string_end</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string_end</span> <span class="o">=</span> <span class="s1">&#39;&lt;extra_id_1&gt;&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.mask_string_end_encoded" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mask_string_end_encoded</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mask_string_end_encoded</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self)._tokenizer.encode">encode</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self).mask_string_end">mask_string_end</span></span><span class="p">,</span> <span class="n"><span title="icx360.utils.infillers.T5_infiller.T5_infiller(self)._tokenizer.encode(add_special_tokens)">add_special_tokens</span></span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.decode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">decode</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">decode</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function to decode text via T5 tokenizer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>tokens</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>skip_special_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>True if to skip special tokens in
decoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>string frame decoding all input tokens</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.encode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">encode</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function to encode text via T5 tokenizer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>text</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>string to encode</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>add_special_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>True if to use special tokens in
encoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>token indices where n is based on input text</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked_word</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">return_mask_filled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate text to infill mask tokens. Assumes one of tokens is
    <extra_id_0>  which is token id self.mask_string_encoded
Args:
    tokens (int list): token indices
    num_return_sequences (int): number of generations to return
        (default: 1)
    masked_word (str): word that is masked in tokens (default: '')
    return_mask_filled (bool): if true, return (ret, mask_filled),
        else return only ret</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>list of token indices after calling model.generate
on input tokens</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>mask_filled</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>decoded version of infilled texts</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.get_infilled_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_infilled_mask</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_infilled_mask</span><span class="p">(</span><span class="n">x_enc</span><span class="p">,</span> <span class="n">y_enc</span><span class="p">,</span> <span class="n">return_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieve text that replaced <extra_id_0>  when infilling from generation
    output</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_enc</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices where one token is <extra_id_0>, i.e.
input to generation function</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_enc</code></b>
              (<code>int list</code>)
          –
          <div class="doc-md-description">
            <p>token indices representing same as x_enc with
several tokens replacing <extra_id_0>, i.e., output of
generation function</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_tokens</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>if true, return (mask_filled, inds_infill),
else return only mask_filled</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>mask_filled</code></b> (              <code><span title="str">str</span></code>
)          –
          <div class="doc-md-description">
            <p>decoded tokens that replace <extra_id_0> which
are between <extra_id_0> and <extra_id_1> in x_enc</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>inds_infill</code></b> (              <code>int list</code>
)          –
          <div class="doc-md-description">
            <p>tokens that represent the replacement for
the mask (only returned if return_tokens==True)</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.infillers.T5_infiller.T5_infiller.similar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">similar</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">similar</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">fill_in</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Determine if word is similar to fill_in</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>word</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>words to search for</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>fill_in</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>filled in text to search for word in</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="bool">bool</span></code>
)          –
          <div class="doc-md-description">
            <p>True if word is similar to fill_in, False otherwise</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.model_wrappers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">model_wrappers</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing wrappers for different types of models (used by MExGen and CELL).</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            base_model_wrapper (icx360.utils.model_wrappers.base_model_wrapper)" href="#icx360.utils.model_wrappers.base_model_wrapper">base_model_wrapper</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for model wrappers and class for model-generated outputs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            huggingface (icx360.utils.model_wrappers.huggingface)" href="#icx360.utils.model_wrappers.huggingface">huggingface</a></code></b>
          –
          <div class="doc-md-description">
            <p>Wrapper for HuggingFace models.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            vllm (icx360.utils.model_wrappers.vllm)" href="#icx360.utils.model_wrappers.vllm">vllm</a></code></b>
          –
          <div class="doc-md-description">
            <p>Wrapper for VLLM models.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.utils.model_wrappers.base_model_wrapper" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">base_model_wrapper</span>


</h5>

    <div class="doc doc-contents ">

        <p>Base class for model wrappers and class for model-generated outputs.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code></b>
          –
          <div class="doc-md-description">
            <p>Holds outputs of generate() method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.base_model_wrapper.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for wrappers of different types of models.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">GeneratedOutput</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">GeneratedOutput</span><span class="p">(</span><span class="n">output_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_token_count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logits</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Holds outputs of generate() method.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            output_ids


  
      instance-attribute
   (icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_ids)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_ids">output_ids</a></code></b>
              (<code><span title="torch.Tensor">Tensor</span> or None</code>)
          –
          <div class="doc-md-description">
            <p>Generated token IDs for each input.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            output_text


  
      instance-attribute
   (icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_text)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_text">output_text</a></code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>] or None</code>)
          –
          <div class="doc-md-description">
            <p>Generated text for each input.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            output_token_count


  
      instance-attribute
   (icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_token_count)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_token_count">output_token_count</a></code></b>
              (<code><span title="int">int</span> or None</code>)
          –
          <div class="doc-md-description">
            <p>Maximum number of generated tokens.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            logits


  
      instance-attribute
   (icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.logits)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.logits">logits</a></code></b>
              (<code><span title="torch.Tensor">Tensor</span> or None</code>)
          –
          <div class="doc-md-description">
            <p>Output logits for each input.</p>
          </div>
        </li>
    </ul>

        <p>Initialize GeneratedOutput.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>output_ids</code></b>
              (<code><span title="torch.Tensor">Tensor</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generated token IDs for each input.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_text</code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generated text for each input.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_token_count</code></b>
              (<code><span title="int">int</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum number of generated tokens.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>logits</code></b>
              (<code><span title="torch.Tensor">Tensor</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Output logits for each input.</p>
          </div>
        </li>
    </ul>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.logits" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logits</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logits</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput(logits)">logits</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_ids" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_ids</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">output_ids</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput(output_ids)">output_ids</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_text" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_text</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">output_text</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput(output_text)">output_text</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput.output_token_count" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_token_count</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">output_token_count</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput(output_token_count)">output_token_count</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h6 id="icx360.utils.model_wrappers.base_model_wrapper.Model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Model</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for wrappers of different types of models.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.base_model_wrapper.Model._model">_model</span></code></b>
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
    </ul>

        <p>Initialize Model wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            convert_input (icx360.utils.model_wrappers.base_model_wrapper.Model.convert_input)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model.convert_input">convert_input</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert input(s) as needed for the model type.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            generate


  
      abstractmethod
   (icx360.utils.model_wrappers.base_model_wrapper.Model.generate)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model.generate">generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate response from model.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.base_model_wrapper.Model.convert_input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_input</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_input</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert input(s) as needed for the model type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>inputs</code></b> (              <code>type required by model</code>
)          –
          <div class="doc-md-description">
            <p>Converted inputs.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.base_model_wrapper.Model.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">text_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate response from model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>text_only</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Return only generated text (default) or an object containing additional outputs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_obj</code></b> (              <code><span title="List">List</span>[<span title="str">str</span>] or <a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code>
)          –
          <div class="doc-md-description">
            <p>If text_only == True, a list of generated texts corresponding to inputs.
If text_only == False, a GeneratedOutput object to hold outputs.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.model_wrappers.huggingface" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">huggingface</span>


</h5>

    <div class="doc doc-contents ">

        <p>Wrapper for HuggingFace models.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            HFModel (icx360.utils.model_wrappers.huggingface.HFModel)" href="#icx360.utils.model_wrappers.huggingface.HFModel">HFModel</a></code></b>
          –
          <div class="doc-md-description">
            <p>Wrapper for HuggingFace models.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.model_wrappers.huggingface.HFModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">HFModel</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">HFModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code></p>


        <p>Wrapper for HuggingFace models.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.huggingface.HFModel._model">_model</span></code></b>
              (<code>transformers model object</code>)
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.huggingface.HFModel._tokenizer">_tokenizer</span></code></b>
              (<code>transformers tokenizer</code>)
          –
          <div class="doc-md-description">
            <p>Tokenizer corresponding to model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.huggingface.HFModel._device">_device</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Device on which the model resides.</p>
          </div>
        </li>
    </ul>

        <p>Initialize HFModel wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code>transformers model object</code>)
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tokenizer</code></b>
              (<code>transformers tokenizer</code>)
          –
          <div class="doc-md-description">
            <p>Tokenizer corresponding to model.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            convert_input (icx360.utils.model_wrappers.huggingface.HFModel.convert_input)" href="#icx360.utils.model_wrappers.huggingface.HFModel.convert_input">convert_input</a></code></b>
            –
            <div class="doc-md-description">
              <p>Encode input text as token IDs for HuggingFace model.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            generate (icx360.utils.model_wrappers.huggingface.HFModel.generate)" href="#icx360.utils.model_wrappers.huggingface.HFModel.generate">generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate response from model.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.huggingface.HFModel.convert_input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_input</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_input</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">chat_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Encode input text as token IDs for HuggingFace model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>chat_template</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>system_prompt</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>System prompt to include in chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for tokenizer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>input_encoding</code></b> (              <code><span title="transformers.BatchEncoding">BatchEncoding</span></code>
)          –
          <div class="doc-md-description">
            <p>Object produced by tokenizer.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.huggingface.HFModel.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">chat_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tokenizer_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate response from model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>chat_template</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>system_prompt</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>System prompt to include in chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tokenizer_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for tokenizer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>text_only</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Return only generated text (default) or an object containing additional outputs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for HuggingFace model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_obj</code></b> (              <code><span title="List">List</span>[<span title="str">str</span>] or <a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code>
)          –
          <div class="doc-md-description">
            <p>If text_only == True, a list of generated texts corresponding to inputs.
If text_only == False, a GeneratedOutput object containing the following:
    output_ids: (num_inputs, output_token_count) torch.Tensor of generated token IDs.
    output_text: List of generated texts.
    output_token_count: Maximum number of generated tokens.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.model_wrappers.vllm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">vllm</span>


</h5>

    <div class="doc doc-contents ">

        <p>Wrapper for VLLM models.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            VLLMModel (icx360.utils.model_wrappers.vllm.VLLMModel)" href="#icx360.utils.model_wrappers.vllm.VLLMModel">VLLMModel</a></code></b>
          –
          <div class="doc-md-description">
            <p>Wrapper for VLLM models.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.model_wrappers.vllm.VLLMModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">VLLMModel</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">VLLMModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code></p>


        <p>Wrapper for VLLM models.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.vllm.VLLMModel._model">_model</span></code></b>
              (<code>OpenAI model object</code>)
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.vllm.VLLMModel._model_name">_model_name</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of the model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="icx360.utils.model_wrappers.vllm.VLLMModel._tokenizer">_tokenizer</span></code></b>
              (<code>transformers tokenizer or None</code>)
          –
          <div class="doc-md-description">
            <p>HuggingFace tokenizer corresponding to the model (for applying chat template).</p>
          </div>
        </li>
    </ul>

        <p>Initialize VLLMModel wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code>OpenAI model object</code>)
          –
          <div class="doc-md-description">
            <p>Underlying model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_name</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of the model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tokenizer</code></b>
              (<code>transformers tokenizer or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>HuggingFace tokenizer corresponding to the model (for applying chat template).</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            convert_input (icx360.utils.model_wrappers.vllm.VLLMModel.convert_input)" href="#icx360.utils.model_wrappers.vllm.VLLMModel.convert_input">convert_input</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert input(s) into a list of strings.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            generate (icx360.utils.model_wrappers.vllm.VLLMModel.generate)" href="#icx360.utils.model_wrappers.vllm.VLLMModel.generate">generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate response from model.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.vllm.VLLMModel.convert_input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_input</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_input</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">chat_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert input(s) into a list of strings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>chat_template</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>system_prompt</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>System prompt to include in chat template.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>inputs</code></b> (              <code><span title="List">List</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Converted input(s) as a list of strings.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.model_wrappers.vllm.VLLMModel.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">chat_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate response from model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>chat_template</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>system_prompt</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>System prompt to include in chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>text_only</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Return only generated text (default) or an object containing additional outputs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for VLLM model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>output_obj</code></b> (              <code><span title="List">List</span>[<span title="str">str</span>] or <a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code>
)          –
          <div class="doc-md-description">
            <p>If text_only == True, a list of generated texts corresponding to inputs.
If text_only == False, a GeneratedOutput object containing the following:
    output_text: List of generated texts.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.scalarizers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">scalarizers</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing scalarizers, which compute scalar output values based on the outputs or inputs of an LLM.</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            bart_score (icx360.utils.scalarizers.bart_score)" href="#icx360.utils.scalarizers.bart_score">bart_score</a></code></b>
          –
          <div class="doc-md-description">
            <p>BARTScorer class used by icx360.utils.scalarizers.TextScalarizedModel.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            base_scalarizer (icx360.utils.scalarizers.base_scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer">base_scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for scalarizers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            bleu_scalarizer (icx360.utils.scalarizers.bleu_scalarizer)" href="#icx360.utils.scalarizers.bleu_scalarizer">bleu_scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class BleuScalarizer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            contradiction_scalarizer (icx360.utils.scalarizers.contradiction_scalarizer)" href="#icx360.utils.scalarizers.contradiction_scalarizer">contradiction_scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class ContradictionScalarizer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            nli_scalarizer (icx360.utils.scalarizers.nli_scalarizer)" href="#icx360.utils.scalarizers.nli_scalarizer">nli_scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class NLIScalarizer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            preference_scalarizer (icx360.utils.scalarizers.preference_scalarizer)" href="#icx360.utils.scalarizers.preference_scalarizer">preference_scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>File containing class PreferenceScalarizer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            prob (icx360.utils.scalarizers.prob)" href="#icx360.utils.scalarizers.prob">prob</a></code></b>
          –
          <div class="doc-md-description">
            <p>Scalarized model that computes the log probability of generating a reference output conditioned on inputs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            text_only (icx360.utils.scalarizers.text_only)" href="#icx360.utils.scalarizers.text_only">text_only</a></code></b>
          –
          <div class="doc-md-description">
            <p>Scalarized model that computes similarity scores between generated texts and a reference output text.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.bart_score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">bart_score</span>


</h5>

    <div class="doc doc-contents ">

        <p>BARTScorer class used by icx360.utils.scalarizers.TextScalarizedModel.</p>
<p>This file (excluding this docstring) is an exact copy of the core source file from the BARTScore authors:
    https://github.com/neulab/BARTScore/blob/main/bart_score.py.
It is licensed under the Apache License Version 2.0.</p>
<p>For more information, please refer to the BARTScore paper:
    BARTScore: Evaluating Generated Text as Text Generation.
    Weizhe Yuan, Graham Neubig, and Pengfei Liu.
    Advances in Neural Information Processing Systems (NeurIPS) 2021.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            BARTScorer (icx360.utils.scalarizers.bart_score.BARTScorer)" href="#icx360.utils.scalarizers.bart_score.BARTScorer">BARTScorer</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.bart_score.BARTScorer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BARTScorer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">BARTScorer</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">checkpoint</span><span class="o">=</span><span class="s1">&#39;facebook/bart-large-cnn&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">











<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            load (icx360.utils.scalarizers.bart_score.BARTScorer.load)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.load">load</a></code></b>
            –
            <div class="doc-md-description">
              <p>Load model from paraphrase finetuning</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            multi_ref_score (icx360.utils.scalarizers.bart_score.BARTScorer.multi_ref_score)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.multi_ref_score">multi_ref_score</a></code></b>
            –
            <div class="doc-md-description">
              
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            score (icx360.utils.scalarizers.bart_score.BARTScorer.score)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.score">score</a></code></b>
            –
            <div class="doc-md-description">
              <p>Score a batch of examples</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            test (icx360.utils.scalarizers.bart_score.BARTScorer.test)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.test">test</a></code></b>
            –
            <div class="doc-md-description">
              <p>Test</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            device


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.device)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.device">device</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            loss_fct


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.loss_fct)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.loss_fct">loss_fct</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            lsm


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.lsm)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.lsm">lsm</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            max_length


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.max_length)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.max_length">max_length</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.model)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.model">model</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            tokenizer


  
      instance-attribute
   (icx360.utils.scalarizers.bart_score.BARTScorer.tokenizer)" href="#icx360.utils.scalarizers.bart_score.BARTScorer.tokenizer">tokenizer</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.device" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">device</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">device</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.bart_score.BARTScorer(device)">device</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.loss_fct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loss_fct</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">loss_fct</span> <span class="o">=</span> <span class="n"><span title="torch.nn.NLLLoss">NLLLoss</span></span><span class="p">(</span><span class="n"><span title="torch.nn.NLLLoss(reduction)">reduction</span></span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n"><span title="torch.nn.NLLLoss(ignore_index)">ignore_index</span></span><span class="o">=</span><span class="n"><span title="icx360.utils.scalarizers.bart_score.BARTScorer(self).model.config.pad_token_id">pad_token_id</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.lsm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">lsm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">lsm</span> <span class="o">=</span> <span class="n"><span title="torch.nn.LogSoftmax">LogSoftmax</span></span><span class="p">(</span><span class="n"><span title="torch.nn.LogSoftmax(dim)">dim</span></span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.max_length" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_length</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">max_length</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.bart_score.BARTScorer(max_length)">max_length</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="transformers.BartForConditionalGeneration.from_pretrained">from_pretrained</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.bart_score.BARTScorer(checkpoint)">checkpoint</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.tokenizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tokenizer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tokenizer</span> <span class="o">=</span> <span class="n"><span title="transformers.BartTokenizer.from_pretrained">from_pretrained</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.bart_score.BARTScorer(checkpoint)">checkpoint</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load model from paraphrase finetuning</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.multi_ref_score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">multi_ref_score</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">multi_ref_score</span><span class="p">(</span><span class="n">srcs</span><span class="p">,</span> <span class="n">tgts</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]],</span> <span class="n">agg</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">score</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">score</span><span class="p">(</span><span class="n">srcs</span><span class="p">,</span> <span class="n">tgts</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Score a batch of examples</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.bart_score.BARTScorer.test" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">test</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">test</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Test</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.base_scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">base_scalarizer</span>


</h5>

    <div class="doc doc-contents ">

        <p>Base class for scalarizers.</p>
<p>Scalarizers compute real-valued scalar outputs for text inputs or outputs of LLMs, for example by
comparing the inputs to a reference input or the corresponding outputs to a reference output.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.base_scalarizer.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for scalarizers.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.base_scalarizer.Scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Scalarizer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Scalarizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for scalarizers.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.base_scalarizer.Scalarizer.model)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a> or None</code>)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object (optional, default None).</p>
          </div>
        </li>
    </ul>

        <p>Initialize Scalarizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object (optional, default None).</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output


  
      abstractmethod
   (icx360.utils.scalarizers.base_scalarizer.Scalarizer.scalarize_output)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute scalar outputs.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.base_scalarizer.Scalarizer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.base_scalarizer.Scalarizer.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute scalar outputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Inputs to compute scalar outputs for:
A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Outputs to scalarize (corresponding to inputs).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference input used to scalarize.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span> or <a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference output (text or GeneratedOutput object) used to scalarize.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>scalar_outputs</code></b> (              <code>(num_inputs,) torch.Tensor</code>
)          –
          <div class="doc-md-description">
            <p>Scalar output for each input.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.bleu_scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">bleu_scalarizer</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class BleuScalarizer</p>
<p>This class is used to scalarize text using a Bleu metric</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            BleuScalarizer (icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer)" href="#icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer">BleuScalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>BleuScalarizer object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BleuScalarizer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">BleuScalarizer</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>BleuScalarizer object.</p>
<p>Instances of BleuScalarizer can call scalarize_output to produce
scalarized version of input text accoring to BLEU score</p>
<p>Attributes
    _bleu: model for computing BLEU score
    _device: device on which to perform computations</p>

        <p>Initialize bleu scalarizer object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. deprecated here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cuda&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform computations</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>experiment_id</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;id&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>unique string for parallel scores to be
computed without issue</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.scalarize_output)" href="#icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert text input and outputs to numerical score</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.model)" href="#icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.model">model</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.bleu_scalarizer.BleuScalarizer.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">input_label</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert text input and outputs to numerical score</p>
<p>Use BLEU score to scalarize. Compute BLEU(outputs, ref_output) and
BLEU(inputs, ref_input) and output a linear combination of BLEU
scores</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>response to input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>contrastive prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>response to contrastive prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_label</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>score</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>scalarized output</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>label_contrast</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.contradiction_scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">contradiction_scalarizer</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class ContradictionScalarizer</p>
<p>This class is used to scalarize text using a Contradiction metric via
Natural Language Inference (NLI)</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            ContradictionScalarizer (icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer)" href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer">ContradictionScalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>ContradictionScalarizer object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ContradictionScalarizer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ContradictionScalarizer</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;cross-encoder/nli-deberta-v3-base&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>ContradictionScalarizer object.</p>
<p>Instances of ContradictionScalarizer can call scalarize_output to produce
scalarized version of input text accoring to Contradiction score</p>
<p>Attributes
    _model: NLI model for computing contradiction score
    _tokenizer: tokenizer of NLI model
    _device: device on which to perform computations</p>

        <p>Initialize contradiction scalarizer object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cross-encoder/nli-deberta-v3-base&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>NLI model for computing contradiction score</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cuda&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform computations</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            predict_contradiction (icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.predict_contradiction)" href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.predict_contradiction">predict_contradiction</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert text input and outputs to 0/1 classification</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.scalarize_output)" href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert text input and outputs to numerical score</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.model)" href="#icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.model">model</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.predict_contradiction" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">predict_contradiction</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">predict_contradiction</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert text input and outputs to 0/1 classification</p>
<p>Use NLI contradiction score to scalarize. Compute
if ref_output contradicts outputs and normalize by contradiction
score of outputs to outputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>response to input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>response to contrastive prompt</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>if contradiction found return 1, else return 0.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.contradiction_scalarizer.ContradictionScalarizer.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">input_label</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert text input and outputs to numerical score</p>
<p>Use NLI contradiction score to scalarize. Compute
if ref_output contradicts outputs and normalize by contradiction
score of outputs to outputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>response to input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>response to contrastive prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_label</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>print extra information if True</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>score</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>scalarized output</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>label_contrast</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.nli_scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">nli_scalarizer</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class NLIScalarizer</p>
<p>This class is used to scalarize text using an Natural Language Inference (NLI)
score to measure the change in scores</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            NLIScalarizer (icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer)" href="#icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer">NLIScalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>NLIScalarizer object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NLIScalarizer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">NLIScalarizer</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;cross-encoder/nli-deberta-v3-base&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>NLIScalarizer object.</p>
<p>Instances of NLIScalarizer can call scalarize_output to produce
scalarized version of input text accoring to change in NLI score</p>
<p>Attributes
    _model: NLI model for computing contradiction score
    _tokenizer: tokenizer of NLI model
    _device: device on which to perform computations</p>

        <p>Initialize nli scalarizer object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cross-encoder/nli-deberta-v3-base&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>NLI model for computing nli score</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cuda&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform computations</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.scalarize_output)" href="#icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert text input and outputs to numerical score</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.model)" href="#icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.model">model</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.nli_scalarizer.NLIScalarizer.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">input_label</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert text input and outputs to numerical score</p>
<p>Use NLI score to scalarize. Compute score of NLI prediction of
NLI(inputs, outputs) and compute change in score for that class of
NLI(inputs, ref_output)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>response to input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>response to contrastive prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_label</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>print extra information if True</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>score</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>scalarized output</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>label_contrast</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.preference_scalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">preference_scalarizer</span>


</h5>

    <div class="doc doc-contents ">

        <p>File containing class PreferenceScalarizer</p>
<p>This class is used to scalarize text using a preference model to measure the
change in preference for a contrastive response to the original prompt</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            PreferenceScalarizer (icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer)" href="#icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer">PreferenceScalarizer</a></code></b>
          –
          <div class="doc-md-description">
            <p>PreferenceScalarizer object.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PreferenceScalarizer</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">PreferenceScalarizer</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;stanfordnlp/SteamSHP-flan-t5-large&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>PreferenceScalarizer object.</p>
<p>Instances of PreferenceScalarizer can call scalarize_output to produce
scalarized version of input text accoring to change in preference of a
contrastive response relative to the initial response</p>
<p>Attributes
    _model: model for computing preference score
    _tokenizer: tokenizer of preference model
    _device: device on which to perform computations</p>

        <p>Initialize preference scalarizer object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model_path</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;stanfordnlp/SteamSHP-flan-t5-large&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>preference model</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;cuda&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>device on which to perform computations</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.scalarize_output)" href="#icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert text input and outputs to numerical score</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.model)" href="#icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.model">model</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.preference_scalarizer.PreferenceScalarizer.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">input_label</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert text input and outputs to numerical score</p>
<p>Use preference score to scalarize. Compute preference for prompt
inputs relative to two different responses, outputs and ref_output.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>response to input prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>response to contrastive prompt</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_label</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>info</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>score</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>scalarized output</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>label_contrast</code></b> (              <code><span title="int">int</span></code>
)          –
          <div class="doc-md-description">
            <p>placeholder. not used here.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.prob" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">prob</span>


</h5>

    <div class="doc doc-contents ">

        <p>Scalarized model that computes the log probability of generating a reference output conditioned on inputs.</p>
<p>This "scalarized model" is a generative model that can also compute the log probability (or a transformation thereof)
of generating a given reference output conditioned on inputs.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            ProbScalarizedModel (icx360.utils.scalarizers.prob.ProbScalarizedModel)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel">ProbScalarizedModel</a></code></b>
          –
          <div class="doc-md-description">
            <p>Generative model that also computes the probability of a given reference output conditioned on inputs.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.prob.ProbScalarizedModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ProbScalarizedModel</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ProbScalarizedModel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>Generative model that also computes the probability of a given reference output conditioned on inputs.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.prob.ProbScalarizedModel.model)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
    </ul>

        <p>Initialize ProbScalarizedModel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="TypeError">TypeError</span></code>
            –
          <div class="doc-md-description">
            <p>If the model is not an icx360.utils.model_wrappers.HFModel
or an icx360.utils.model_wrappers.VLLMModel.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.prob.ProbScalarizedModel.scalarize_output)" href="#icx360.utils.scalarizers.prob.ProbScalarizedModel.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute probability of reference output conditioned on inputs.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.prob.ProbScalarizedModel.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.prob.ProbScalarizedModel.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chat_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tokenizer_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">transformation</span><span class="o">=</span><span class="s1">&#39;log_prob_mean&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute probability of reference output conditioned on inputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Inputs to compute probabilities for:
A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Outputs to scalarize (corresponding to inputs) - not used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference input used to scalarize - not used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference output object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>chat_template</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to apply chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>system_prompt</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>System prompt to include in chat template.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tokenizer_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for tokenizer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>transformation</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;log_prob_mean&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Transformation to apply to token probabilities.
    "log_prob_mean": arithmetic mean of log probabilities (default).
    "log_prob_sum": sum of log probabilities.
    "prob_geo_mean": geometric mean of probabilities.
    "prob_prod": product of probabilities.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>probs_transformed</code></b> (              <code>(num_inputs,) torch.Tensor</code>
)          –
          <div class="doc-md-description">
            <p>Transformed probability of generating the reference output conditioned on each input.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.scalarizers.text_only" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">text_only</span>


</h5>

    <div class="doc doc-contents ">

        <p>Scalarized model that computes similarity scores between generated texts and a reference output text.</p>
<p>This "scalarized model" is a generative model that can also compute similarity scores
between the texts it generates and a reference output text.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            TextScalarizedModel (icx360.utils.scalarizers.text_only.TextScalarizedModel)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel">TextScalarizedModel</a></code></b>
          –
          <div class="doc-md-description">
            <p>Generative model that also computes similarity scores between its generated texts and a reference text.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.scalarizers.text_only.TextScalarizedModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TextScalarizedModel</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TextScalarizedModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sim_scores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nli_logit&#39;</span><span class="p">,</span> <span class="s1">&#39;bert&#39;</span><span class="p">,</span> <span class="s1">&#39;st&#39;</span><span class="p">,</span> <span class="s1">&#39;summ&#39;</span><span class="p">,</span> <span class="s1">&#39;bart&#39;</span><span class="p">],</span> <span class="n">model_nli</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_bert</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_st</span><span class="o">=</span><span class="s1">&#39;all-MiniLM-L6-v2&#39;</span><span class="p">,</span> <span class="n">model_summ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_bart</span><span class="o">=</span><span class="s1">&#39;facebook/bart-large-cnn&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            Scalarizer (icx360.utils.scalarizers.Scalarizer)" href="#icx360.utils.scalarizers.base_scalarizer.Scalarizer">Scalarizer</a></code></p>


        <p>Generative model that also computes similarity scores between its generated texts and a reference text.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.model)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.model">model</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            sim_scores


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.sim_scores)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.sim_scores">sim_scores</a></code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of similarity scores to compute.
    "nli_logit"/"nli": Logit/probability of entailment label from natural language inference model.
    "bert": BERTScore.
    "st": Cosine similarity between SentenceTransformer embeddings.
    "summ": Generation probability of a summarization model (similar to BARTScore).
    "bart": BARTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model_nli


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.model_nli)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.model_nli">model_nli</a></code></b>
              (<code><span title="transformers.AutoModelForSequenceClassification">AutoModelForSequenceClassification</span></code>)
          –
          <div class="doc-md-description">
            <p>Natural language inference model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            tokenizer_nli


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_nli)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_nli">tokenizer_nli</a></code></b>
              (<code><span title="transformers.AutoTokenizer">AutoTokenizer</span></code>)
          –
          <div class="doc-md-description">
            <p>Tokenizer for natural language inference model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            idx_entail


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.idx_entail)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.idx_entail">idx_entail</a></code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index corresponding to entailment label.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            bertscore


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.bertscore)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.bertscore">bertscore</a></code></b>
              (<code><span title="evaluate.EvaluationModule">EvaluationModule</span></code>)
          –
          <div class="doc-md-description">
            <p>BERTScore evaluation module.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model_bert


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.model_bert)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.model_bert">model_bert</a></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of BERT-like model for computing BERTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model_st


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.model_st)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.model_st">model_st</a></code></b>
              (<code>SentenceTransformer model</code>)
          –
          <div class="doc-md-description">
            <p>SentenceTransformer embedding model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model_summ


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.model_summ)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.model_summ">model_summ</a></code></b>
              (<code><span title="transformers.AutoModelForSeq2SeqLM">AutoModelForSeq2SeqLM</span></code>)
          –
          <div class="doc-md-description">
            <p>Summarization model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            tokenizer_summ


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_summ)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_summ">tokenizer_summ</a></code></b>
              (<code><span title="transformers.AutoTokenizer">AutoTokenizer</span></code>)
          –
          <div class="doc-md-description">
            <p>Tokenizer for summarization model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            bart_scorer


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.bart_scorer)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.bart_scorer">bart_scorer</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            BARTScorer (icx360.utils.scalarizers.BARTScorer)" href="#icx360.utils.scalarizers.bart_score.BARTScorer">BARTScorer</a></code>)
          –
          <div class="doc-md-description">
            <p>Object for computing BARTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            device


  
      instance-attribute
   (icx360.utils.scalarizers.text_only.TextScalarizedModel.device)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.device">device</a></code></b>
              (<code><span title="torch.device">device</span> or <span title="str">str</span> or None</code>)
          –
          <div class="doc-md-description">
            <p>Device for the above models.</p>
          </div>
        </li>
    </ul>

        <p>Initialize TextScalarizedModel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Model (icx360.utils.model_wrappers.Model)" href="#icx360.utils.model_wrappers.base_model_wrapper.Model">Model</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generative model, wrapped in an icx360.utils.model_wrappers.Model object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sim_scores</code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>]</code>, default:
                  <code>[&#39;nli_logit&#39;, &#39;bert&#39;, &#39;st&#39;, &#39;summ&#39;, &#39;bart&#39;]</code>
)
          –
          <div class="doc-md-description">
            <p>List of similarity scores to compute.
    "nli_logit"/"nli": Logit/probability of entailment label from natural language inference model.
    "bert": BERTScore.
    "st": Cosine similarity between SentenceTransformer embeddings.
    "summ": Generation probability of a summarization model (similar to BARTScore).
    "bart": BARTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_nli</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of natural language inference model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_bert</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of BERT-like model for computing BERTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_st</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;all-MiniLM-L6-v2&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of SentenceTransformer embedding model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_summ</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of summarization model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_bart</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;facebook/bart-large-cnn&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of BART-like model for computing BARTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>device</code></b>
              (<code><span title="torch.device">device</span> or <span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Device for the above models.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalarize_output (icx360.utils.scalarizers.text_only.TextScalarizedModel.scalarize_output)" href="#icx360.utils.scalarizers.text_only.TextScalarizedModel.scalarize_output">scalarize_output</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute similarity scores between generated texts and reference text.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.bart_scorer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bart_scorer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">bart_scorer</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            BARTScorer (icx360.utils.scalarizers.BARTScorer)" href="#icx360.utils.scalarizers.bart_score.BARTScorer">BARTScorer</a></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.BARTScorer(device)">device</span></span><span class="o">=</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(self).device">device</span></span><span class="p">,</span> <span class="n"><span title="icx360.utils.scalarizers.BARTScorer(checkpoint)">checkpoint</span></span><span class="o">=</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(model_bart)">model_bart</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.bertscore" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bertscore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">bertscore</span> <span class="o">=</span> <span class="n"><span title="evaluate.load">load</span></span><span class="p">(</span><span class="s1">&#39;bertscore&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.device" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">device</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">device</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            select_device (icx360.utils.general_utils.select_device)" href="#icx360.utils.general_utils.select_device">select_device</a></span><span class="p">()</span> <span class="k">if</span> <span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(device)">device</span></span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(device)">device</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.idx_entail" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">idx_entail</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">idx_entail</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(self).model_nli.config.label2id">label2id</span></span><span class="p">[</span><span class="n"><span title="key">key</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.base_scalarizer.Scalarizer(model)">model</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.model_bert" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_bert</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model_bert</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(model_bert)">model_bert</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.model_nli" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_nli</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model_nli</span> <span class="o">=</span> <span class="n"><span title="to">to</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(self).device">device</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.model_st" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_st</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model_st</span> <span class="o">=</span> <span class="n"><span title="sentence_transformers.SentenceTransformer">SentenceTransformer</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(model_st)">model_st</span></span><span class="p">,</span> <span class="n"><span title="sentence_transformers.SentenceTransformer(device)">device</span></span><span class="o">=</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(self).device">device</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.model_summ" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_summ</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model_summ</span> <span class="o">=</span> <span class="n"><span title="to">to</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(self).device">device</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.sim_scores" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sim_scores</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sim_scores</span> <span class="o">=</span> <span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(sim_scores)">sim_scores</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_nli" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tokenizer_nli</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tokenizer_nli</span> <span class="o">=</span> <span class="n"><span title="transformers.AutoTokenizer.from_pretrained">from_pretrained</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(model_nli)">model_nli</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.tokenizer_summ" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tokenizer_summ</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tokenizer_summ</span> <span class="o">=</span> <span class="n"><span title="transformers.AutoTokenizer.from_pretrained">from_pretrained</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.scalarizers.text_only.TextScalarizedModel(model_summ)">model_summ</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.scalarizers.text_only.TextScalarizedModel.scalarize_output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">scalarize_output</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scalarize_output</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_new_tokens_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">idf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="s1">&#39;log_prob_mean&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute similarity scores between generated texts and reference text.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>inputs</code></b>
              (<code><span title="str">str</span> or <span title="List">List</span>[<span title="str">str</span>] or <span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Inputs to compute similarity scores for:
A single input text, a list of input texts, or a list of segmented texts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outputs</code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generated texts to compute similarity scores for.
If None, then will be generated by calling self.model.generate().</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_input</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference input used to scalarize - not used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code><a class="autorefs autorefs-internal" title="            GeneratedOutput (icx360.utils.model_wrappers.GeneratedOutput)" href="#icx360.utils.model_wrappers.base_model_wrapper.GeneratedOutput">GeneratedOutput</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reference output object containing reference text (ref_output.output_text).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_new_tokens_factor</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.5</code>
)
          –
          <div class="doc-md-description">
            <p>Multiplicative factor for setting max_new_tokens for generation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>symmetric</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Make NLI entailment score symmetric
(geometric mean of reference -&gt; generated and generated -&gt; reference).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idf</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Use idf weighting for BERTScore.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>transformation</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;log_prob_mean&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Transformation to apply to output token probabilities of summarization model.
    "log_prob_mean": arithmetic mean of log probabilities (default).
    "log_prob_sum": sum of log probabilities.
    "prob_geo_mean": geometric mean of probabilities.
    "prob_prod": product of probabilities.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>scores</code></b> (              <code>dict of (num_inputs,) torch.Tensor</code>
)          –
          <div class="doc-md-description">
            <p>For each label in self.sim_scores, a Tensor of corresponding similarity scores
between generated texts and the reference text.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.segmenters" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">segmenters</span>


</h4>

    <div class="doc doc-contents ">

        <p>Module containing utilities for segmenting input text into units.</p>






<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            spacy (icx360.utils.segmenters.spacy)" href="#icx360.utils.segmenters.spacy">spacy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class and functions for segmenting input text into units using a spaCy model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            utils (icx360.utils.segmenters.utils)" href="#icx360.utils.segmenters.utils">utils</a></code></b>
          –
          <div class="doc-md-description">
            <p>Other utilities for segmenting input text into units.</p>
          </div>
        </li>
    </ul>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h5 id="icx360.utils.segmenters.spacy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">spacy</span>


</h5>

    <div class="doc doc-contents ">

        <p>Class and functions for segmenting input text into units using a spaCy model.</p>
<p>SpaCySegmenter is the main class.
The remaining functions implement an algorithm for segmentation into phrases.</p>








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            SpaCySegmenter (icx360.utils.segmenters.spacy.SpaCySegmenter)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter">SpaCySegmenter</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class for segmenting input text into units using a spaCy model.</p>
          </div>
        </li>
    </ul>




<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            append_or_segment_children (icx360.utils.segmenters.spacy.append_or_segment_children)" href="#icx360.utils.segmenters.spacy.append_or_segment_children">append_or_segment_children</a></code></b>
            –
            <div class="doc-md-description">
              <p>Append syntactic children of a node as phrases or further segment them.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            append_or_segment_span (icx360.utils.segmenters.spacy.append_or_segment_span)" href="#icx360.utils.segmenters.spacy.append_or_segment_span">append_or_segment_span</a></code></b>
            –
            <div class="doc-md-description">
              <p>Append span to list of phrases or further segment span.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_not_punct_space (icx360.utils.segmenters.spacy.is_not_punct_space)" href="#icx360.utils.segmenters.spacy.is_not_punct_space">is_not_punct_space</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks whether each token of span is not punctuation and not a space</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            merge_nbor_of_singleton_phrase (icx360.utils.segmenters.spacy.merge_nbor_of_singleton_phrase)" href="#icx360.utils.segmenters.spacy.merge_nbor_of_singleton_phrase">merge_nbor_of_singleton_phrase</a></code></b>
            –
            <div class="doc-md-description">
              <p>Decide whether to merge neighbor of singleton (single-token) phrase.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            merge_noun_chunk_phrases (icx360.utils.segmenters.spacy.merge_noun_chunk_phrases)" href="#icx360.utils.segmenters.spacy.merge_noun_chunk_phrases">merge_noun_chunk_phrases</a></code></b>
            –
            <div class="doc-md-description">
              <p>Merge phrases that constitute a noun chunk.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            merge_phrase_spans (icx360.utils.segmenters.spacy.merge_phrase_spans)" href="#icx360.utils.segmenters.spacy.merge_phrase_spans">merge_phrase_spans</a></code></b>
            –
            <div class="doc-md-description">
              <p>Merge phrases within specified spans of phrases.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            merge_singleton_phrases (icx360.utils.segmenters.spacy.merge_singleton_phrases)" href="#icx360.utils.segmenters.spacy.merge_singleton_phrases">merge_singleton_phrases</a></code></b>
            –
            <div class="doc-md-description">
              <p>Merge single-token phrases with their neighbors.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            segment_into_phrases (icx360.utils.segmenters.spacy.segment_into_phrases)" href="#icx360.utils.segmenters.spacy.segment_into_phrases">segment_into_phrases</a></code></b>
            –
            <div class="doc-md-description">
              <p>Segment sentence (or span within sentence) into phrases.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            sort_phrases (icx360.utils.segmenters.spacy.sort_phrases)" href="#icx360.utils.segmenters.spacy.sort_phrases">sort_phrases</a></code></b>
            –
            <div class="doc-md-description">
              <p>Sort phrases by their starting token index.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h6 id="icx360.utils.segmenters.spacy.SpaCySegmenter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">SpaCySegmenter</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SpaCySegmenter</span><span class="p">(</span><span class="n">spacy_model</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Class for segmenting input text into units using a spaCy model.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            model


  
      instance-attribute
   (icx360.utils.segmenters.spacy.SpaCySegmenter.model)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter.model">model</a></code></b>
              (<code><span title="spacy.Language">Language</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy model.</p>
          </div>
        </li>
    </ul>

        <p>Initialize SpaCySegmenter object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>spacy_model</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of spaCy model.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            segment_units (icx360.utils.segmenters.spacy.SpaCySegmenter.segment_units)" href="#icx360.utils.segmenters.spacy.SpaCySegmenter.segment_units">segment_units</a></code></b>
            –
            <div class="doc-md-description">
              <p>(Further) Segment input text into units.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h7 id="icx360.utils.segmenters.spacy.SpaCySegmenter.model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="spacy.load">load</span></span><span class="p">(</span><span class="n"><span title="icx360.utils.segmenters.spacy.SpaCySegmenter(spacy_model)">spacy_model</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h7 id="icx360.utils.segmenters.spacy.SpaCySegmenter.segment_units" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">segment_units</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">segment_units</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">ind_segment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_types</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">sent_idxs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">segment_type</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>(Further) Segment input text into units.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>input_text</code></b>
              (<code><span title="str">str</span> or <span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Input text as a single unit (if str) or existing sequence of units (list[str]).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ind_segment</code></b>
              (<code><span title="bool">bool</span> or <span title="list">list</span>[<span title="bool">bool</span>]</code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to segment entire input text or each existing unit.
If bool, applies to all units. If list[bool], applies to each unit individually.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit_types</code></b>
              (<code><span title="str">str</span> or <span title="list">list</span>[<span title="str">str</span>]</code>, default:
                  <code>&#39;s&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Types of units in input_text:
    "p" for paragraph, "s" for sentence, "w" for word,
    "n" for not to be perturbed or segmented (fixed).
If str, applies to all units in input_text, otherwise unit-specific.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sent_idxs</code></b>
              (<code><span title="list">list</span>[<span title="int">int</span>] or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Index of sentence (or larger unit) that contains each existing unit.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segment_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;w&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of units to segment into: "s" for sentences, "w" for words, "ph" for phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum phrase length in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>units</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Resulting sequence of units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>unit_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>sent_idxs_new</code></b> (              <code><span title="list">list</span>[<span title="int">int</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Index of sentence (or larger unit) that contains each unit.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.append_or_segment_children" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">append_or_segment_children</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">append_or_segment_children</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Append syntactic children of a node as phrases or further segment them.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>children</code></b>
              (<code><span title="generator">generator</span>[<span title="spacy.tokens.Token">Token</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Generator of syntactic children.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of current phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of current phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum phrase length in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Updated list of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Updated list of phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>need_sort</code></b> (              <code><span title="bool">bool</span></code>
)          –
          <div class="doc-md-description">
            <p>Flag to indicate whether phrases need sorting.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.append_or_segment_span" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">append_or_segment_span</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">append_or_segment_span</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Append span to list of phrases or further segment span.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>span</code></b>
              (<code><span title="spacy.tokens.Span">Span</span></code>)
          –
          <div class="doc-md-description">
            <p>Span to be appended or further segmented.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of current phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of current phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum phrase length in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Updated list of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Updated list of phrase types.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.is_not_punct_space" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">is_not_punct_space</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_not_punct_space</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks whether each token of span is not punctuation and not a space</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A list of Booleans where each element is True iff corresponding token is not punctuation and not a space.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.merge_nbor_of_singleton_phrase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">merge_nbor_of_singleton_phrase</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_nbor_of_singleton_phrase</span><span class="p">(</span><span class="n">nbor</span><span class="p">,</span> <span class="n">singleton</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">max_nbor_length</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Decide whether to merge neighbor of singleton (single-token) phrase.</p>
<p>Evaluates conditions to determine if a neighboring phrase should be merged with a singleton phrase.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>nbor</code></b>
              (<code><span title="spacy.tokens.Span">Span</span></code>)
          –
          <div class="doc-md-description">
            <p>Neighboring phrase.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>singleton</code></b>
              (<code><span title="spacy.tokens.Span">Span</span></code>)
          –
          <div class="doc-md-description">
            <p>Singleton phrase.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>offset</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Absolute difference between indices of neighboring and singleton phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_nbor_length</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Maximum neighbor length for merging in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ret</code></b> (              <code><span title="bool">bool</span></code>
)          –
          <div class="doc-md-description">
            <p>Whether to merge neighbor.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.merge_noun_chunk_phrases" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">merge_noun_chunk_phrases</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_noun_chunk_phrases</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">,</span> <span class="n">noun_chunks</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge phrases that constitute a noun chunk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>noun_chunks</code></b>
              (<code><span title="generator">generator</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Generator of noun chunks.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases_merged</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>List of merged phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types_merged</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of merged phrases.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.merge_phrase_spans" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">merge_phrase_spans</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_phrase_spans</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">,</span> <span class="n">spans_merge</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge phrases within specified spans of phrases.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>spans_merge</code></b>
              (<code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrase spans, each a 2-element tuple of a starting phrase index and an ending phrase index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases_merged</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>List of merged phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types_merged</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of merged phrases.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.merge_singleton_phrases" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">merge_singleton_phrases</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_singleton_phrases</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge single-token phrases with their neighbors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrase types.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum phrase length in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases_merged</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>List of merged phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types_merged</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of merged phrases.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.segment_into_phrases" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">segment_into_phrases</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">segment_into_phrases</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_phrase_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Segment sentence (or span within sentence) into phrases.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>sent</code></b>
              (<code><span title="spacy.tokens.Span">Span</span></code>)
          –
          <div class="doc-md-description">
            <p>Sentence or span to be segmented.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>doc</code></b>
              (<code><span title="spacy.tokens.Doc">Doc</span></code>)
          –
          <div class="doc-md-description">
            <p>spaCy Doc containing the sentence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_phrase_length</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum phrase length in terms of spaCy tokens.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>List of segmented phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of phrases (e.g., "ROOT", "non-leaf", spaCy dependency labels).</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.spacy.sort_phrases" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">sort_phrases</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sort_phrases</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="n">phrase_types</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sort phrases by their starting token index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>phrases</code></b>
              (<code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phrase_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of phrase types.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>phrases</code></b> (              <code><span title="list">list</span>[<span title="spacy.tokens.Span">Span</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Sorted list of phrases.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>phrase_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Types of sorted phrases.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h5 id="icx360.utils.segmenters.utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">utils</span>


</h5>

    <div class="doc doc-contents ">

        <p>Other utilities for segmenting input text into units.</p>










<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            exclude_non_alphanumeric (icx360.utils.segmenters.utils.exclude_non_alphanumeric)" href="#icx360.utils.segmenters.utils.exclude_non_alphanumeric">exclude_non_alphanumeric</a></code></b>
            –
            <div class="doc-md-description">
              <p>Exclude units without alphanumeric characters.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h6 id="icx360.utils.segmenters.utils.exclude_non_alphanumeric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">exclude_non_alphanumeric</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">exclude_non_alphanumeric</span><span class="p">(</span><span class="n">unit_types</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Exclude units without alphanumeric characters.</p>
<p>Modifies the <code>unit_types</code> list by setting the type of units without alphanumeric characters to "n".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>unit_types</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Types of units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Sequence of units.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>unit_types</code></b> (              <code><span title="list">list</span>[<span title="str">str</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Updated types of units.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.subset_utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">subset_utils</span>


</h4>

    <div class="doc doc-contents ">

        <p>Utilities that deal with subsets of input units.</p>
<p>These utilities are used by MExGen C-LIME (icx360.algorithms.mexgen.clime)
and L-SHAP (icx360.algorithms.mexgen.lshap).</p>










<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            mask_subsets (icx360.utils.subset_utils.mask_subsets)" href="#icx360.utils.subset_utils.mask_subsets">mask_subsets</a></code></b>
            –
            <div class="doc-md-description">
              <p>Mask subsets of units with a fixed replacement string.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            sample_subsets (icx360.utils.subset_utils.sample_subsets)" href="#icx360.utils.subset_utils.sample_subsets">sample_subsets</a></code></b>
            –
            <div class="doc-md-description">
              <p>Sample subsets of input units that can be replaced.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="icx360.utils.subset_utils.mask_subsets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">mask_subsets</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mask_subsets</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">subsets_replace</span><span class="p">,</span> <span class="n">replacement_str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Mask subsets of units with a fixed replacement string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>units</code></b>
              (<code><span title="List">List</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Original sequence of units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>subsets_replace</code></b>
              (<code><span title="List">List</span>[<span title="List">List</span>[<span title="int">int</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>A list of subsets to replace, where each subset is a list of unit indices.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>replacement_str</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>String to replace units with (default "" for dropping units).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>input_masked</code></b> (              <code><span title="List">List</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>
)          –
          <div class="doc-md-description">
            <p>A list of masked versions of <code>units</code>,
where each masked version corresponds to a subset in <code>subsets_replace</code>.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="icx360.utils.subset_utils.sample_subsets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">sample_subsets</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_subsets</span><span class="p">(</span><span class="n">idx_replace</span><span class="p">,</span> <span class="n">max_units_replace</span><span class="p">,</span> <span class="n">oversampling_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">empty_subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample subsets of input units that can be replaced.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx_replace</code></b>
              (<code>num_replace,) np.ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Indices of units that can be replaced.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_units_replace</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Maximum number of units to replace at one time.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>oversampling_factor</code></b>
              (<code><span title="float">float</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Ratio of number of perturbed inputs to be generated to number of units that can be replaced.
Default None means no upper bound on this ratio.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_return_sequences</code></b>
              (<code><span title="int">int</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Number of perturbed inputs to generate for each subset of units to replace.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>empty_subset</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the empty subset.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_weights</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return weights associated with subsets.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>subsets</code></b> (              <code><span title="list">list</span>[<span title="list">list</span>[<span title="int">int</span>]]</code>
)          –
          <div class="doc-md-description">
            <p>A list of subsets, where each subset is a list of unit indices.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>weights</code></b> (              <code><span title="list">list</span>[<span title="float">float</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Weights associated with subsets, only returned if return_weights==True.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="icx360.utils.toma" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toma</span>


</h4>

    <div class="doc doc-contents ">

        <p>Model inference utilities that use the toma package to avoid running out of CUDA memory.</p>










<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            toma_call (icx360.utils.toma.toma_call)" href="#icx360.utils.toma.toma_call">toma_call</a></code></b>
            –
            <div class="doc-md-description">
              <p>Call model using the toma package to adapt to CUDA memory constraints.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            toma_generate (icx360.utils.toma.toma_generate)" href="#icx360.utils.toma.toma_generate">toma_generate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate outputs using the toma package to adapt to CUDA memory constraints.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            toma_get_probs (icx360.utils.toma.toma_get_probs)" href="#icx360.utils.toma.toma_get_probs">toma_get_probs</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute log probabilities of tokens in a given reference output using the toma package to adapt to CUDA memory.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="icx360.utils.toma.toma_call" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toma_call</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toma_call</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">input_dict</span><span class="p">,</span> <span class="n">logits</span><span class="p">,</span> <span class="n">output_hidden_states</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hidden_states</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Call model using the toma package to adapt to CUDA memory constraints.</p>
<p>This function passes a batch of inputs to a transformers classification model.
It produces logits and, optionally, hidden states, and stores them in pre-allocated Tensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>start</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the first input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>end</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the last input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code>transformers model</code>)
          –
          <div class="doc-md-description">
            <p>Classification model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_dict</code></b>
              (<code><span title="dict">dict</span> - <span title="like">like</span></code>)
          –
          <div class="doc-md-description">
            <p>Dict-like object produced by a HuggingFace tokenizer, containing input data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>logits</code></b>
              (<code>num_inputs, num_labels) torch.Tensor</code>)
          –
          <div class="doc-md-description">
            <p>Pre-allocated Tensor to store logits.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_hidden_states</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to also output model's hidden states/representations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>hidden_states</code></b>
              (<code><span title="tuple">tuple</span>(<span title="torch.Tensor">Tensor</span>) or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If output_hidden_states == True, then for each layer of the model,
a pre-allocated (num_inputs, input_length, hidden_dim) Tensor of hidden states/representations,
to be populated by toma_call. Otherwise, None.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>None.</p>
          </div>
        </li>
    </ul>
        <p>This function modifies the provided logits Tensor in-place with predicted logits and, if requested,
the hidden_states tuple with corresponding hidden states.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="icx360.utils.toma.toma_generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toma_generate</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toma_generate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">input_dict</span><span class="p">,</span> <span class="n">output_ids</span><span class="p">,</span> <span class="n">output_hidden_states</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hidden_states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate outputs using the toma package to adapt to CUDA memory constraints.</p>
<p>This function passes a batch of inputs to a transformers generative model.
It generates token IDs and, optionally, hidden states, and stores them in pre-allocated Tensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>start</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the first input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>end</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the last input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code>transformers model</code>)
          –
          <div class="doc-md-description">
            <p>Generative model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_dict</code></b>
              (<code><span title="dict">dict</span> - <span title="like">like</span></code>)
          –
          <div class="doc-md-description">
            <p>Dict-like object produced by a HuggingFace tokenizer, containing input data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_ids</code></b>
              (<code>num_inputs, gen_start + max_new_tokens) torch.Tensor</code>)
          –
          <div class="doc-md-description">
            <p>Pre-allocated Tensor to store generated token IDs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_hidden_states</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to also output model's hidden states/representations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>hidden_states</code></b>
              (<code><span title="tuple">tuple</span>(<span title="torch.Tensor">Tensor</span>) or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If output_hidden_states == True, then for each layer of the encoder,
a pre-allocated (num_inputs, input_length, hidden_dim) Tensor of hidden states/representations,
to be populated by toma_generate. Otherwise, None.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments for the HuggingFace model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>None.</p>
          </div>
        </li>
    </ul>
        <p>This function modifies the provided output_ids Tensor in-place with generated token IDs and, if requested,
the hidden_states tuple with corresponding hidden states.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="icx360.utils.toma.toma_get_probs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toma_get_probs</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toma_get_probs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">input_dict</span><span class="p">,</span> <span class="n">ref_output</span><span class="p">,</span> <span class="n">log_probs</span><span class="p">,</span> <span class="n">output_hidden_states</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hidden_states</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute log probabilities of tokens in a given reference output using the toma package to adapt to CUDA memory.</p>
<p>This function passes a batch of inputs to a transformers generative model.
It computes log probabilities of reference output tokens conditioned on these outputs
and, optionally, hidden states, and stores them in pre-allocated Tensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>start</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the first input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>end</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the last input in the batch.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model</code></b>
              (<code>transformers model</code>)
          –
          <div class="doc-md-description">
            <p>Generative model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>input_dict</code></b>
              (<code><span title="dict">dict</span> - <span title="like">like</span></code>)
          –
          <div class="doc-md-description">
            <p>Dict-like object produced by a HuggingFace tokenizer, containing input data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ref_output</code></b>
              (<code>1, num_output_tokens) torch.Tensor</code>)
          –
          <div class="doc-md-description">
            <p>Token IDs of reference output to compute log probabilities for.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>log_probs</code></b>
              (<code>num_inputs, gen_length) torch.Tensor</code>)
          –
          <div class="doc-md-description">
            <p>Pre-allocated Tensor to store log probabilities.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_hidden_states</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to also output model's hidden states/representations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>hidden_states</code></b>
              (<code><span title="tuple">tuple</span>(<span title="torch.Tensor">Tensor</span>) or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If output_hidden_states == True, then for each layer of the model,
a pre-allocated (num_inputs, input_length, hidden_dim) Tensor of hidden states/representations,
to be populated by toma_get_probs. Otherwise, None.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>None.</p>
          </div>
        </li>
    </ul>
        <p>This function modifies the provided log_probs Tensor in-place with predicted log probabilities and, if requested,
the hidden_states tuple with corresponding hidden states.</p>


    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../examples/th/LLM_jailbreak/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Token Highlighter Jailbreak Inspector">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Token Highlighter Jailbreak Inspector
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "announce.dismiss", "navigation.footer", "navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>